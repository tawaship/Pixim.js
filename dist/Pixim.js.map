{"version":3,"file":"Pixim.js","sources":["../node_modules/@tawaship/emitter/dist/Emitter.esm.js","../src/modules/Emitter.ts","../node_modules/@tawaship/task/dist/Task.esm.js","../src/modules/Task.ts","../src/modules/Container.ts","../src/modules/Application.ts","../src/modules/ContentManifestBase.ts","../src/modules/ContentImageManifest.ts","../src/modules/ContentSpritesheetManifest.ts","../src/modules/ContentSoundManifest.ts","../src/modules/ContentDeliver.ts","../src/modules/Content.ts"],"sourcesContent":["/*!\n * @tawaship/emitter - v3.1.1\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Emitter {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    _on(type, callback, once) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ callback, once });\r\n        return this;\r\n    }\r\n    /**\r\n     * Register event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    on(type, callback) {\r\n        return this._on(type, callback, false);\r\n    }\r\n    /**\r\n     * Register one-time event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    once(type, callback) {\r\n        return this._on(type, callback, true);\r\n    }\r\n    /**\r\n     * Unregister event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Registered callback.\r\n     */\r\n    off(type, callback) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                events.splice(i, 1);\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _emit(type, context, ...args) {\r\n        if (!type) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        const targets = [];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            const event = events[i];\r\n            if (event.once) {\r\n                events.splice(i, 1);\r\n            }\r\n            targets.push(event);\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit event.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emit(type, ...args) {\r\n        return this._emit(type, this, ...args);\r\n    }\r\n    /**\r\n     * Emit event with specifying a context.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemit(type, context, ...args) {\r\n        return this._emit(type, context, ...args);\r\n    }\r\n    _emitAll(context, ...args) {\r\n        if (context == null) {\r\n            return this;\r\n        }\r\n        const targets = [];\r\n        for (let type in this._events) {\r\n            const events = this._events[type] || [];\r\n            for (let i = events.length - 1; i >= 0; i--) {\r\n                const event = events[i];\r\n                if (event.once) {\r\n                    events.splice(i, 1);\r\n                }\r\n                targets.push(event);\r\n            }\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit all events.\r\n     *\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emitAll(...args) {\r\n        return this._emitAll(this, ...args);\r\n    }\r\n    /**\r\n     * Emit all events with specifying a context.\r\n     *\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemitAll(context, ...args) {\r\n        return this._emitAll(context, ...args);\r\n    }\r\n    /**\r\n     * Remove events grouped event type.\r\n     *\r\n     * @param type Event type to remove. If it is empty, removes all events.\r\n     */\r\n    clear(type = '') {\r\n        if (type) {\r\n            delete (this._events[type]);\r\n        }\r\n        else {\r\n            this._events = {};\r\n        }\r\n        return this;\r\n    }\r\n}\n\nexport { Emitter };\n//# sourceMappingURL=Emitter.esm.js.map\n","import { Emitter as _Emitter } from '@tawaship/emitter';\r\n\r\n/**\r\n * [[https://tawaship.github.io/Emitter/index.html | @tawaship/emitter]]\r\n */\r\nexport class Emitter extends _Emitter {}","/*!\n * @tawaship/task - v1.1.0\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Task {\r\n    constructor(callbacks, context) {\r\n        this._taskData = {\r\n            context: context == null ? this : context,\r\n            enabled: true,\r\n            index: -1,\r\n            callbacks: [],\r\n            value: null\r\n        };\r\n        this.add(callbacks);\r\n    }\r\n    /**\r\n     * Whether the task works.\r\n     */\r\n    get enabled() {\r\n        return this._taskData.enabled;\r\n    }\r\n    set enabled(enabled) {\r\n        this._taskData.enabled = enabled;\r\n    }\r\n    /**\r\n     * Add the task to the end of the list.\r\n     */\r\n    add(callbacks) {\r\n        if (!Array.isArray(callbacks)) {\r\n            callbacks = [callbacks];\r\n        }\r\n        const list = this._taskData.callbacks;\r\n        const flag = list.length === 0;\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            if (!(callbacks[i] instanceof Function)) {\r\n                continue;\r\n            }\r\n            list.push(callbacks[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Execute the current task.\r\n     */\r\n    done(...args) {\r\n        if (!this._taskData.enabled) {\r\n            return;\r\n        }\r\n        const task = this._taskData.callbacks[this._taskData.index];\r\n        if (!task) {\r\n            return;\r\n        }\r\n        return this._taskData.value = task.apply(this._taskData.context, args);\r\n    }\r\n    _to(index) {\r\n        this._taskData.index = Number(index);\r\n        return this;\r\n    }\r\n    /**\r\n     * Change the current task to the first task.\r\n     */\r\n    first() {\r\n        return this._to(0);\r\n    }\r\n    /**\r\n     * Change the current task to the previos task.\r\n     */\r\n    prev() {\r\n        return this._to(this._taskData.index - 1);\r\n    }\r\n    /**\r\n     * Change the current task to the next task.\r\n     */\r\n    next() {\r\n        return this._to(this._taskData.index + 1);\r\n    }\r\n    /**\r\n     * Change the current task to the specified task.\r\n     */\r\n    to(index) {\r\n        return this._to(index);\r\n    }\r\n    /**\r\n     * Skips all tasks and changes to the finished state.\r\n     */\r\n    finish() {\r\n        this._taskData.index = -1;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancel all task and leave them unregistered.\r\n     */\r\n    reset() {\r\n        this._taskData.callbacks = [];\r\n        this._taskData.index = -1;\r\n        this._taskData.value = null;\r\n        return this;\r\n    }\r\n    /**\r\n     * Destroy instance.\r\n     */\r\n    destroy() {\r\n        this.reset();\r\n    }\r\n    /**\r\n     * The value returned by the last task executed.\r\n     */\r\n    get value() {\r\n        return this._taskData.value;\r\n    }\r\n}\n\nexport { Task };\n//# sourceMappingURL=Task.esm.js.map\n","import { Emitter } from './Emitter';\r\nimport { Task as _Task, ITaskDelegate } from '@tawaship/task';\r\n\r\nexport interface ITaskData {\r\n\temitter: Emitter\r\n}\r\n\r\n/**\r\n * [[https://tawaship.github.io/Task/index.html | @tawaship/task]]\r\n */\r\nexport class Task extends _Task {\r\n\tprivate _piximData: ITaskData;\r\n\t\r\n\tconstructor(tasks: ITaskDelegate | ITaskDelegate[], context: any) {\r\n\t\tsuper(tasks, context);\r\n\t\t\r\n\t\tthis.enabled = true;\r\n\t\tthis._piximData = {\r\n\t\t\temitter: new Emitter()\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\ton(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.on(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\tonce(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.once(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\toff(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.off(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\temit(type: string, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.emit(type, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\tcemit(type: string, context: any, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.cemit(type, context, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.9.0\r\n\t */\r\n\temitAll(...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.emitAll(...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.9.0\r\n\t */\r\n\tcemitAll(context: any, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.cemitAll(context, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @deprecated 1.7.0\r\n\t */\r\n\tclear(type: string = '') {\r\n\t\tthis._piximData.emitter.clear(type);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tdestroy() {\r\n\t\tsuper.destroy();\r\n\t\tthis.clear();\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { Task } from './Task';\r\n//import { TaskManager } from './TaskManager';\r\nimport { ITickerData } from './Application';\r\n\r\nexport interface IContainerData {\r\n\ttask: Task,\r\n\ttaskEnabledChildren: boolean\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nlet _lastObserverID = 0;\r\n\r\n/**\r\n * [[http://pixijs.download/release/docs/PIXI.Container.html]]\r\n */\r\nexport class Container extends PIXI.Container {\r\n\tprotected _piximData: IContainerData;\r\n\t\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\ttask: new Task([], this),\r\n\t\t\ttaskEnabledChildren: true\r\n\t\t};\r\n\t\t\r\n\t\tthis._piximData.task.first();\r\n\t\t\r\n\t\tconst _observerID = _lastObserverID++;\r\n\t\t/*\r\n\t\tthis.on('added', () => {\r\n\t\t\tTaskManager.addObserver(_observerID, this);\r\n\t\t});\r\n\t\t\r\n\t\tthis.on('removed', () => {\r\n\t\t\tTaskManager.removeObserver(_observerID);\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\t\r\n\tupdateTask(e: ITickerData) {\r\n\t\tconst task: Task = this._piximData.task;\r\n\t\t\r\n\t\tif (!this._piximData.task.enabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tlet p: PIXI.DisplayObject = this;\r\n\t\tlet f = true;\r\n\t\t\r\n\t\twhile (p) {\r\n\t\t\tif (p instanceof Container && !p.taskEnabledChildren) {\r\n\t\t\t\tf = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tp = p.parent;\r\n\t\t}\r\n\t\t\r\n\t\tif (!f) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\ttask.done(e);\r\n\t\t\r\n\t\t// will be deprecated\r\n\t\ttask.cemitAll(this, e);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether the task works.\r\n\t */\r\n\tget taskEnabled(): boolean {\r\n\t\treturn this._piximData.task.enabled;\r\n\t}\r\n\t\r\n\tset taskEnabled(enabled) {\r\n\t\tthis._piximData.task.enabled = enabled;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether the children and subsequent tasks work.\r\n\t */\r\n\tget taskEnabledChildren(): boolean {\r\n\t\treturn this._piximData.taskEnabledChildren;\r\n\t}\r\n\t\r\n\tset taskEnabledChildren(enabled) {\r\n\t\tthis._piximData.taskEnabledChildren = enabled;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Task object that works only while it is being displayed.\r\n\t */\r\n\tget task(): Task {\r\n\t\treturn this._piximData.task;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Destroy instance.\r\n\t * \r\n\t * @override\r\n\t */\r\n\tdestroy(...args: any[]): void {\r\n\t\tsuper.destroy(...args);\r\n\t\tthis._piximData.task.destroy();\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { Content } from './Content';\r\nimport { Container } from './Container';\r\nimport { Emitter } from './Emitter';\r\n//import { TaskManager } from './TaskManager';\r\n\r\nexport interface IRootDictionary {\r\n\t[id: string]: PIXI.Container;\r\n}\r\n\r\nexport interface ILayerDictionary{\r\n\t[name: string]: Layer;\r\n}\r\n\r\nexport interface ITickerData {\r\n\tdelta: number\r\n}\r\n\r\nexport interface IAdjustDelegate {\r\n\t(app: Application): void;\r\n}\r\n\r\nexport type TAutoAdjust = boolean | IAdjustDelegate;\r\n\r\nexport interface IAutoAdjustDelegate {\r\n\t(): void;\r\n}\r\n\r\nexport type TAutoAdjuster = IAutoAdjustDelegate | null;\r\n\r\nexport interface IApplicationOption {\r\n\t/**\r\n\t * Parent node of canvas element.\r\n\t */\r\n\tcontainer?: HTMLElement;\r\n\t\r\n\t/**\r\n\t * Whether to automatically resize the canvas when resizing the window.<br />\r\n\t * Or the resizing process to be executed at that time.\r\n\t */\r\n\tautoAdjust?: TAutoAdjust;\r\n}\r\n\r\nexport interface IApplicationData {\r\n\tisRun: boolean;\r\n\t/**\r\n\t * [[[[http://pixijs.download/v5.2.1/docs/PIXI.Application.html | PIXI.Application]]]]\r\n\t */\r\n\tapp: PIXI.Application;\r\n\tcontainer: HTMLElement;\r\n\tlayers: ILayerDictionary;\r\n\tautoAdjuster: TAutoAdjuster;\r\n\troots: IRootDictionary;\r\n}\r\n\r\nexport interface ISize {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IPosition {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport interface IHorizontal {\r\n\tx: number;\r\n\twidth: number;\r\n}\r\n\r\nexport interface IVertical {\r\n\ty: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IRect extends ISize, IPosition {}\r\n\r\nexport interface IDestroyOptions {\r\n\tchildren?: boolean;\r\n\ttexture?: boolean;\r\n\tbaseTexture?: boolean;\r\n}\r\n\r\nexport class Layer extends PIXI.Container {}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction taskHandler(obj: PIXI.Container, e: ITickerData): void {\r\n\tif (obj instanceof Container) {\r\n\t\tobj.updateTask(e);\r\n\t\t\r\n\t\tif (!obj.taskEnabledChildren) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst children: PIXI.DisplayObject[] = [];\r\n\t\r\n\tfor (let i = 0; i < obj.children.length; i++) {\r\n\t\tchildren.push(obj.children[i]);\r\n\t}\r\n\t\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tconst child = children[i];\r\n\t\t\r\n\t\tif (child instanceof PIXI.Container) {\r\n\t\t\ttaskHandler(child, e);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Application extends Emitter {\r\n\tprotected _piximData: IApplicationData;\r\n\t\r\n\t/**\r\n\t * @param pixiOptions Optional data when call 'new [[[[http://pixijs.download/v5.2.1/docs/PIXI.Application.html | PIXI.Application]]]]'.\r\n\t * @param piximOptions Optional data for Pixim.\r\n\t */\r\n\tconstructor(pixiOptions: Object = {}, piximOptions: IApplicationOption = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tconst app: PIXI.Application = new PIXI.Application(pixiOptions);\r\n\t\tapp.stop();\r\n\t\t\r\n\t\tapp.view.style.position = 'absolute';\r\n\t\t\r\n\t\tconst autoAdjust: TAutoAdjust = piximOptions.autoAdjust || false;\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\tisRun: false,\r\n\t\t\tapp,\r\n\t\t\tcontainer: piximOptions.container || document.body,\r\n\t\t\tlayers: {},\r\n\t\t\tautoAdjuster: null,\r\n\t\t\troots: {}\r\n\t\t};\r\n\t\t\r\n\t\tconst ticker: PIXI.Ticker = this._piximData.app.ticker;\r\n\t\t\r\n\t\tticker.add((delta: number) => {\r\n\t\t\t//TaskManager.done({ delta });\r\n\t\t\ttaskHandler(this._piximData.app.stage, { delta });\r\n\t\t});\r\n\t\t\r\n\t\tif (autoAdjust) {\r\n\t\t\tif (autoAdjust === true) {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tthis.fullScreen()\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tautoAdjust(this);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tget app(): PIXI.Application {\r\n\t\treturn this._piximData.app;\r\n\t}\r\n\t\r\n\tget stage(): PIXI.Container {\r\n\t\treturn this._piximData.app.stage;\r\n\t}\r\n\t\r\n\tget view(): HTMLCanvasElement {\r\n\t\treturn this._piximData.app.view;\r\n\t}\r\n\t\r\n\tget container(): HTMLElement {\r\n\t\treturn this._piximData.container;\r\n\t}\r\n\t\r\n\tset container(container: HTMLElement) {\r\n\t\tthis._piximData.container = container || document.body;\r\n\t\tif (this._piximData.app.view.parentNode) {\r\n\t\t\tthis._piximData.container.appendChild(this._piximData.app.view);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether application has layer.\r\n\t */\r\n\tprivate _hasLayer(name: string): boolean {\r\n\t\treturn !!this._piximData.layers[name];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Add layer to application.\r\n\t */\r\n\taddLayer(name: string) {\r\n\t\tif (this._hasLayer(name)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.layers[name] = this._piximData.app.stage.addChild(new Layer());\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove layer form application.\r\n\t */\r\n\tremoveLayer(name: string) {\r\n\t\tif (!this._hasLayer(name)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.app.stage.removeChild(this._piximData.layers[name]);\r\n\t\tdelete(this._piximData.layers[name]);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Attach content to application.\r\n\t */\r\n\tattachAsync(content: Content, layerName: string = 'anonymous'): Promise<PIXI.Container> {\r\n\t\treturn content.buildAsync()\r\n\t\t\t.then((root: PIXI.Container) => {\r\n\t\t\t\tthis.detach(content);\r\n\t\t\t\t\r\n\t\t\t\tthis.addLayer(layerName);\r\n\t\t\t\t\r\n\t\t\t\tthis._piximData.roots[content.contentID] = root;\r\n\t\t\t\tthis._piximData.layers[layerName].addChild(root);\r\n\t\t\t\t\r\n\t\t\t\treturn root;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Detach content from application.\r\n\t */\r\n\tdetach(content: Content, stageOptions: IDestroyOptions = { children: true }) {\r\n\t\tconst root: PIXI.Container = this._piximData.roots[content.contentID];\r\n\t\t\r\n\t\tif (!root) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._destroyRoot(root, stageOptions);\r\n\t\tdelete(this._piximData.roots[content.contentID]);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Start application and displa viewy.\r\n\t */\r\n\tplay() {\r\n\t\tthis._piximData.container.appendChild(this._piximData.app.view);\r\n\t\t\r\n\t\treturn this.start();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Start application.\r\n\t */\r\n\tstart() {\r\n\t\tthis._piximData.app.start();\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Stop application.\r\n\t */\r\n\tstop() {\r\n\t\tthis._piximData.app.stop();\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Pause (or restart) application.\r\n\t */\r\n\tpause(paused: boolean) {\r\n\t\tif (paused) {\r\n\t\t\tthis.stop();\r\n\t\t} else {\r\n\t\t\tthis.start();\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tget autoAdjuster() {\r\n\t\treturn this._piximData.autoAdjuster;\r\n\t}\r\n\t\r\n\tset autoAdjuster(autoAdjuster: TAutoAdjuster) {\r\n\t\tif (this._piximData.autoAdjuster) {\r\n\t\t\twindow.removeEventListener('resize', this._piximData.autoAdjuster);\r\n\t\t}\r\n\t\t\r\n\t\tif (!autoAdjuster) {\r\n\t\t\tthis._piximData.autoAdjuster = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.autoAdjuster = autoAdjuster;\r\n\t\twindow.addEventListener('resize', autoAdjuster);\r\n\t\tautoAdjuster();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Pre process to destroy application.\r\n\t */\r\n\tpreDestroy() {\r\n\t\tthis.autoAdjuster = null;\r\n\t\tthis._piximData.layers = {};\r\n\t\tthis._piximData.roots = {};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Destroy application.\r\n\t */\r\n\tdestroy(removeView?: boolean, stageOptions?: IDestroyOptions) {\r\n\t\tthis.preDestroy();\r\n\t\t\r\n\t\tthis._piximData.app.destroy(removeView, stageOptions);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _destroyRoot(root: PIXI.Container, stageOptions?: IDestroyOptions): void {\r\n\t\troot.destroy(stageOptions);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified rectangle.\r\n\t * \r\n\t * @param rect Rectangle to adjust.\r\n\t */\r\n\tfullScreen(rect?: IRect) {\r\n\t\tconst view: HTMLCanvasElement = this._piximData.app.view;\r\n\t\tconst r: IRect = rect || {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tif (r.width / r.height > view.width / view.height) {\r\n\t\t\treturn this.adjustHeight(r.height).toCenter(r).toTop(r);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.adjustWidth(r.width).toMiddle(r).toLeft(r);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified width.\r\n\t * \r\n\t * @param width Width to adjust.\r\n\t */\r\n\tadjustWidth(width?: number) {\r\n\t\tconst view: HTMLCanvasElement = this._piximData.app.view;\r\n\t\tconst w: number = width || this._piximData.container.offsetWidth || window.innerWidth;\r\n\t\t\r\n\t\tconst h: number = w / view.width * view.height;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.width = `${w}px`;\r\n\t\tview.style.height = `${h}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified height.\r\n\t * \r\n\t * @param height Height to adjust.\r\n\t */\r\n\tadjustHeight(height?: number) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst h: number = height || this._piximData.container.offsetHeight || window.innerHeight;\r\n\t\t\r\n\t\tconst w = h / view.height * view.width;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.height = `${h}px`;\r\n\t\tview.style.width = `${w}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Left justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoLeft(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Center justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoCenter(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${(hol.width - this._getViewRect().width) / 2 + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Right justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoRight(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.width - this._getViewRect().width + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Top justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoTop(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Middle justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoMiddle(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${(ver.height - this._getViewRect().height) / 2 + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Bottom justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoBottom(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.height - this._getViewRect().height + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _getViewRect(): IRect {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\t\r\n\t\treturn {\r\n\t\t\tx: parseInt(view.style.left.replace('px', '')),\r\n\t\t\ty: parseInt(view.style.top.replace('px', '')),\r\n\t\t\twidth: parseInt(view.style.width.replace('px', '')),\r\n\t\t\theight: parseInt(view.style.height.replace('px', ''))\r\n\t\t};\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\n\r\nexport interface IManifestDictionary {\r\n\t[name: string]: string;\r\n}\r\n\r\nexport interface IPreManifest {\r\n\turl: string;\r\n\tunrequired: boolean;\r\n}\r\n\r\nexport interface IPreManifestDictionary {\r\n\t[name: string]: IPreManifest;\r\n}\r\n\r\nexport interface IPostManifest extends IPreManifest {\r\n\tname: string;\r\n}\r\n\r\nexport interface IPostManifestDictionary {\r\n\t[name: string]: IPostManifest;\r\n}\r\n\r\nexport interface IContentManifestOption {\r\n\tunrequired?: boolean\r\n}\r\n\r\nexport interface ILoadedResource {\r\n\tresource: any;\r\n\terror: boolean;\r\n}\r\n\r\nexport interface ILoadedResourceDictionary {\r\n\t[name: string]: ILoadedResource;\r\n}\r\n\r\nexport interface IResourceDictionary {\r\n\t[name: string]: any;\r\n}\r\n\r\nexport interface IContentResourceDictionary {\r\n\t[name: string]: IResourceDictionary;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _cache: IResourceDictionary = {};\r\n\r\nexport abstract class ContentManifestBase {\r\n\tprivate _manifests: IPreManifestDictionary = {};\r\n\t\r\n\t/**\r\n\t * Register manifests.\r\n\t * \r\n\t * @param manifests Defined manifests.\r\n\t * @param option Manifest option data.\r\n\t */\r\n\tadd(manifests: IManifestDictionary, options: IContentManifestOption = {}): void {\r\n\t\tconst unrequired: boolean = options.unrequired || false;\r\n\t\t\r\n\t\tfor (let i in manifests) {\r\n\t\t\tthis._manifests[i] = {\r\n\t\t\t\turl: manifests[i],\r\n\t\t\t\tunrequired\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get resources.\r\n\t * \r\n\t * @param basepath Basement directory path of assets.\r\n\t */\r\n\tgetAsync(basepath: string, version: string): Promise<IResourceDictionary> {\r\n\t\tconst manifests: IPreManifestDictionary = this._manifests;\r\n\t\t\r\n\t\tconst resources: IResourceDictionary = {};\r\n\t\tconst loadable: IPostManifestDictionary = {};\r\n\t\tconst cache = _cache;\r\n\t\t\r\n\t\tfor (let i in manifests) {\r\n\t\t\tconst manifest: IPreManifest = manifests[i];\r\n\t\t\tconst url: string = this._resolvePath(manifest.url, basepath);\r\n\t\t\t\r\n\t\t\t// query parameter is invalid for resource cache\r\n\t\t\tconst name: string = url.replace(/\\?.*/, '');\r\n\t\t\t\r\n\t\t\tif (cache[name]) {\r\n\t\t\t\tresources[i] = cache[name];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tloadable[i] = {\r\n\t\t\t\turl,\r\n\t\t\t\tname,\r\n\t\t\t\tunrequired: manifest.unrequired\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tif (Object.keys(loadable).length === 0) {\r\n\t\t\treturn Promise.resolve(resources);\r\n\t\t}\r\n\t\t\r\n\t\treturn this._loadAsync(loadable, version)\r\n\t\t\t.then((res: ILoadedResourceDictionary) => {\r\n\t\t\t\tfor (let i in res) {\r\n\t\t\t\t\tresources[i] = res[i].resource;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!res[i].error) {\r\n\t\t\t\t\t\tcache[loadable[i].name] = res[i].resource;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn resources;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Load resources.\r\n\t */\r\n\tprotected _loadAsync(manifests: IPostManifestDictionary, version: string): Promise<ILoadedResourceDictionary> {\r\n\t\treturn Promise.resolve({});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Normalize asset path.\r\n\t */\r\n\tprivate _resolvePath(path: string, basepath: string): string {\r\n\t\tif (path.indexOf('http://') === 0 || path.indexOf('https://') === 0) {\r\n\t\t\treturn path;\r\n\t\t} else {\r\n\t\t\treturn PIXI.utils.url.resolve(basepath, path);\r\n\t\t}\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { ContentManifestBase, IManifestDictionary, IContentManifestOption, IPostManifestDictionary, ILoadedResource } from './ContentManifestBase';\r\n\r\nexport interface ILoadedImageResource extends ILoadedResource {\r\n\tresource: PIXI.Texture\r\n}\r\n\r\nexport interface ILoadedImageResourceDictionary {\r\n\t[name: string]: ILoadedImageResource;\r\n}\r\n\r\nexport class ContentImageManifest extends ContentManifestBase {\r\n\t/**\r\n\t * Load image resources.\r\n\t * \r\n\t * @override\r\n\t */\r\n\tprotected _loadAsync(manifests: IPostManifestDictionary, version: string): Promise<ILoadedImageResourceDictionary> {\r\n\t\treturn new Promise((resolve: (resource: ILoadedImageResourceDictionary) => void, reject: (manifest: IManifestDictionary) => void): void => {\r\n\t\t\tconst loader: PIXI.Loader = new PIXI.Loader();\r\n\t\t\t\r\n\t\t\tif (version) {\r\n\t\t\t\tloader.defaultQueryString = `_fv=${version}`;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tloader.add(i, manifests[i].url, {\r\n\t\t\t\t\tcrossOrigin: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst res: ILoadedImageResourceDictionary = {};\r\n\t\t\tloader.load((loader, resources): void => {\r\n\t\t\t\tfor (let i in resources) {\r\n\t\t\t\t\tconst resource: PIXI.LoaderResource | undefined = resources[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!resource) {\r\n\t\t\t\t\t\treject({ [i]: manifests[i].url});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (resource.error && !manifests[i].unrequired) {\r\n\t\t\t\t\t\treject({ [i]: manifests[i].url});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tres[i] = {\r\n\t\t\t\t\t\tresource: resource.texture,\r\n\t\t\t\t\t\terror: !!resource.error\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresolve(res);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { ContentManifestBase, IManifestDictionary, IContentManifestOption, IPostManifestDictionary, ILoadedResource } from './ContentManifestBase';\r\n\r\nexport interface ILoadedSpritesheetResource extends ILoadedResource {\r\n\tresource: PIXI.ITextureDictionary\r\n}\r\n\r\nexport interface ILoadedSpritesheetResourceDictionary {\r\n\t[name: string]: ILoadedSpritesheetResource;\r\n}\r\n\r\nexport class ContentSpritesheetManifest extends ContentManifestBase {\r\n\t/**\r\n\t * Load image resources.\r\n\t * \r\n\t * @override\r\n\t */\r\n\tprotected _loadAsync(manifests: IPostManifestDictionary, version: string): Promise<ILoadedSpritesheetResourceDictionary> {\r\n\t\treturn new Promise((resolve: (resource: ILoadedSpritesheetResourceDictionary) => void, reject: (manifest: IManifestDictionary) => void): void => {\r\n\t\t\tconst loader: PIXI.Loader = new PIXI.Loader();\r\n\t\t\t\r\n\t\t\tif (version) {\r\n\t\t\t\tloader.defaultQueryString = `_fv=${version}`;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tloader.add(i, manifests[i].url, {\r\n\t\t\t\t\tcrossOrigin: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst res: ILoadedSpritesheetResourceDictionary = {};\r\n\t\t\tloader.load((loader, resources): void => {\r\n\t\t\t\tfor (let i in resources) {\r\n\t\t\t\t\tif (!manifests[i]) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst resource: PIXI.LoaderResource | undefined = resources[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!resource) {\r\n\t\t\t\t\t\treject({ [i]: manifests[i].url});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst textures: PIXI.ITextureDictionary = resource.textures || {};\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst error: boolean = !!resource.error;\r\n\t\t\t\t\tif (resource.error && !manifests[i].unrequired) {\r\n\t\t\t\t\t\treject({ [i]: manifests[i].url});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tres[i] = {\r\n\t\t\t\t\t\tresource: textures,\r\n\t\t\t\t\t\terror: !!resource.error\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresolve(res);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}","import { Howl } from 'howler';\r\nimport { ContentManifestBase, IManifestDictionary, IContentManifestOption, IPostManifestDictionary, ILoadedResource } from './ContentManifestBase';\r\n\r\nexport interface ILoadedSoundResource extends ILoadedResource {\r\n\tresource: Howl\r\n}\r\n\r\nexport interface ILoadedSoundResourceDictionary{\r\n\t[name: string]: ILoadedSoundResource;\r\n}\r\n\r\nexport class ContentSoundManifest extends ContentManifestBase {\r\n\t/**\r\n\t * Load image resources.\r\n\t * \r\n\t * @override\r\n\t */\r\n\tprotected _loadAsync(manifests: IPostManifestDictionary, version: string): Promise<ILoadedSoundResourceDictionary> {\r\n\t\treturn new Promise((resolve: (resource: ILoadedSoundResourceDictionary) => void, reject: (manifest: IManifestDictionary) => void): void => {\r\n\t\t\tconst res: ILoadedSoundResourceDictionary = {};\r\n\t\t\t\r\n\t\t\tfunction loadedHandler(key: string, howl: Howl, error: boolean): void {\r\n\t\t\t\tres[key] = {\r\n\t\t\t\t\tresource: howl,\r\n\t\t\t\t\terror\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tif (++loadedCount < loadCount) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresolve(res);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet loadCount: number = 0;\r\n\t\t\tlet loadedCount:number  = 0;\r\n\t\t\t\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tif (!Howl) {\r\n\t\t\t\t\tconsole.warn('You need \"howler.js\" to load sound asset.');\r\n\t\t\t\t\treject({ [i]: manifests[i].url});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t++loadCount;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tconst _i = i;\r\n\t\t\t\tconst url =\r\n\t\t\t\t\tversion\r\n\t\t\t\t\t?`${manifests[_i].url}${manifests[_i].url.match(/\\?/) ? '&' : '?'}_fv=${version}`\r\n\t\t\t\t\t: manifests[_i].url;\r\n\t\t\t\t\r\n\t\t\t\tconst howl = new Howl({\r\n\t\t\t\t\tsrc: url,\r\n\t\t\t\t\tonload: () => {\r\n\t\t\t\t\t\tloadedHandler(_i, howl, false);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonloaderror: () => {\r\n\t\t\t\t\t\tif (!manifests[_i].unrequired) {\r\n\t\t\t\t\t\t\treject({ [_i]: manifests[_i].url});\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tloadedHandler(_i, howl, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { Container } from './Container';\r\nimport { IContentResourceDictionary } from './ContentManifestBase';\r\n\r\nexport interface IContentLibrary {\r\n\t[name: string]: typeof PIXI.Container | typeof Container\r\n}\r\n\r\nexport interface IVariableDictionary {\r\n\t[name: string]: any;\r\n}\r\n\r\nexport interface IContentDeliverData {\r\n\twidth: number,\r\n\theight: number,\r\n\tlib: IContentLibrary,\r\n\tresources: IContentResourceDictionary,\r\n\tvars: IVariableDictionary\r\n}\r\n\r\nexport class ContentDeliver {\r\n\tprotected _piximData: IContentDeliverData;\r\n\t\r\n\tconstructor(data: IContentDeliverData) {\r\n\t\tthis._piximData = {\r\n\t\t\twidth: data.width,\r\n\t\t\theight: data.height,\r\n\t\t\tlib: data.lib,\r\n\t\t\tresources: data.resources,\r\n\t\t\tvars: data.vars\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Content width.\r\n\t */\r\n\tget width(): number {\r\n\t\treturn this._piximData.width;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Content height.\r\n\t */\r\n\tget height(): number {\r\n\t\treturn this._piximData.height;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Defined classes in content.\r\n\t */\r\n\tget lib(): IContentLibrary {\r\n\t\treturn this._piximData.lib;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loaded resources.\r\n\t */\r\n\tget resources(): IContentResourceDictionary {\r\n\t\treturn this._piximData.resources;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Defined variables by framework.\r\n\t */\r\n\tget vars() {\r\n\t\treturn this._piximData.vars;\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport { IResourceDictionary, IContentResourceDictionary, IManifestDictionary, IContentManifestOption } from './ContentManifestBase';\r\nimport { ContentImageManifest } from './ContentImageManifest';\r\nimport { ContentSpritesheetManifest } from './ContentSpritesheetManifest';\r\nimport { ContentSoundManifest } from './ContentSoundManifest';\r\nimport { ContentDeliver, IVariableDictionary, IContentLibrary } from './ContentDeliver';\r\n\r\nexport type TContentManifestType = 'images' | 'spritesheets' | 'sounds';\r\n\r\nexport interface IContentAssetVersion {\r\n\timages?: string;\r\n\tspritesheets?: string;\r\n\tsounds?: string;\r\n}\r\n\r\nexport interface IContentManifests { \r\n\timages: ContentImageManifest;\r\n\tspritesheets: ContentSpritesheetManifest;\r\n\tsounds: ContentSoundManifest;\r\n}\r\n\r\nexport interface IContentConfigData {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IContentData {\r\n\tcontentID: string;\r\n\tbasepath: string;\r\n\tversion: IContentAssetVersion;\r\n\t$: ContentDeliver;\r\n\tmanifests: IContentManifests;\r\n\tadditionalManifests: IContentManifests;\r\n\tpreloadPromise: Promise<void> | null;\r\n\tpostloadPromise: Promise<void> | null;\r\n}\r\n\r\nexport interface TContents {\r\n\t[name: string]: typeof Content;\r\n};\r\n\r\nexport interface IContentOption {\r\n\t/**\r\n\t * Asset root path.\r\n\t */\r\n\tbasepath?: string;\r\n\t\r\n\t/**\r\n\t * Asset version.\r\n\t */\r\n\tversion?: string | IContentAssetVersion;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _contents: TContents = {};\r\n\r\n/**\r\n * @ignore\r\n */\r\nlet _contentID: number = 0;\r\n\r\nexport interface IContentStaticData {\r\n\tconfig: IContentConfigData;\r\n\tmanifests: IContentManifests;\r\n\tlib: IContentLibrary;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createManifests(): IContentManifests {\r\n\treturn {\r\n\t\timages: new ContentImageManifest(),\r\n\t\tspritesheets: new ContentSpritesheetManifest(),\r\n\t\tsounds: new ContentSoundManifest()\r\n\t};\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createContentStatic(): IContentStaticData {\r\n\treturn {\r\n\t\tconfig: {\r\n\t\t\twidth: 450,\r\n\t\t\theight: 800\r\n\t\t},\r\n\t\tmanifests: createManifests(),\r\n\t\tlib: {}\r\n\t};\r\n}\r\n\r\nexport class Content {\r\n\tprotected static _piximData: IContentStaticData;\r\n\tprotected _piximData: IContentData;\r\n\t\r\n\tconstructor(options: IContentOption = {}, piximData: IContentStaticData = Content._piximData) {\r\n\t\tconst basepath: string = (options.basepath || '').replace(/([^/])$/, '$1/');\r\n\t\t\r\n\t\tif (typeof(options.version) !== 'object') {\r\n\t\t\toptions.version = {\r\n\t\t\t\timages: options.version || '',\r\n\t\t\t\tspritesheets: options.version || '',\r\n\t\t\t\tsounds: options.version || ''\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\tcontentID: (++_contentID).toString(),\r\n\t\t\tbasepath,\r\n\t\t\tversion: options.version,\r\n\t\t\t$: new ContentDeliver({\r\n\t\t\t\twidth: piximData.config.width,\r\n\t\t\t\theight: piximData.config.height,\r\n\t\t\t\tlib: piximData.lib,\r\n\t\t\t\tresources: {},\r\n\t\t\t\tvars: {}\r\n\t\t\t}),\r\n\t\t\tmanifests: piximData.manifests,\r\n\t\t\tadditionalManifests: createManifests(),\r\n\t\t\tpreloadPromise: null,\r\n\t\t\tpostloadPromise: null\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Create a cloned content class.\r\n\t * \r\n\t * @param key Content name.\r\n\t * @return Cloned content class.\r\n\t */\r\n\tstatic create(key: string = ''): typeof Content {\r\n\t\tif (key && key in _contents) {\r\n\t\t\tthrow new Error(`Content key '${key}' has already exists.`);\r\n\t\t}\r\n\t\t\r\n\t\tclass ContentClone extends Content {\r\n\t\t\tprotected static _piximData: IContentStaticData = createContentStatic();\r\n\t\t\t\r\n\t\t\tconstructor(options: IContentOption = {}) {\r\n\t\t\t\tsuper(options, ContentClone._piximData);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (!key) {\r\n\t\t\treturn ContentClone;\r\n\t\t}\r\n\t\t\r\n\t\treturn _contents[key] = ContentClone;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get cloned content.\r\n\t */\r\n\tstatic get(key: string) {\r\n\t\treturn _contents[key];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove cloned content.\r\n\t * \r\n\t * @function Pixim.Content.removeContent\r\n\t * @param key {string}\r\n\t */\r\n\tstatic remove(key: string): void {\r\n\t\tdelete(_contents[key]);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define assets for class.\r\n\t */\r\n\tstatic defineManifests(key: TContentManifestType, data: IManifestDictionary, options: IContentManifestOption = {}) {\r\n\t\tif (!this._piximData.manifests[key]) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.manifests[key].add(data, options);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define image assets for class.\r\n\t */\r\n\tstatic defineImages(data: IManifestDictionary, options: IContentManifestOption = {}) {\r\n\t\treturn this.defineManifests('images', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define spritesheet assets for class.\r\n\t */\r\n\tstatic defineSpritesheets(data: IManifestDictionary, options: IContentManifestOption = {}) {\r\n\t\treturn this.defineManifests('spritesheets', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define sound assets for class.\r\n\t */\r\n\tstatic defineSounds(data: IManifestDictionary, options: IContentManifestOption = {}) {\r\n\t\treturn this.defineManifests('sounds', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set the content settings.\r\n\t * \r\n\t * @param data Config data.\r\n\t */\r\n\tstatic setConfig(data: IContentConfigData) {\r\n\t\t//this._piximData.config.fps = data.fps;\r\n\t\tthis._piximData.config.width = data.width;\r\n\t\tthis._piximData.config.height = data.height;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define libraries that is material of the content.<br />\r\n\t * In the constructor named root, Application passes a reference to ContentDeliver as an argument.<br />\r\n\t * By giving this argument to the child further, you will be able to access the data freely from anywhere.\r\n\t * \r\n\t * @param data Library data.\r\n\t */\r\n\tstatic defineLibraries(data: IContentLibrary) {\r\n\t\tfor (let i in data) {\r\n\t\t\tthis._piximData.lib[i] = data[i];\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * ID of this content.\r\n\t */\r\n\tget contentID(): string {\r\n\t\treturn this._piximData.contentID;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddManifests(key: TContentManifestType, data: IManifestDictionary, options: IContentManifestOption = {}): this {\r\n\t\tif (!this._piximData.additionalManifests[key]) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.additionalManifests[key].add(data, options);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define image assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddImages(data: IManifestDictionary, options: IContentManifestOption = {}): this {\r\n\t\treturn this.addManifests('images', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define spritesheet assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddSpritesheets(data: IManifestDictionary, options: IContentManifestOption = {}): this {\r\n\t\treturn this.addManifests('spritesheets', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define sound assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddSounds(data: IManifestDictionary, options: IContentManifestOption = {}): this {\r\n\t\treturn this.addManifests('sounds', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define valriables for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddVars(data: IVariableDictionary): this {\r\n\t\tfor (let i in data) {\r\n\t\t\t this._piximData.$.vars[i] = data[i];\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Prepare content.\r\n\t */\r\n\tprepareAsync(): Promise<void> {\r\n\t\treturn this.preloadClassAssetAsync()\r\n\t\t\t.then(() => {\r\n\t\t\t\treturn this.preloadInstanceAssetAsync();\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Build content.\r\n\t */\r\n\tbuildAsync(): Promise<PIXI.Container> {\r\n\t\tif (!this._piximData.$.lib.root) {\r\n\t\t\tthrow new Error('There is no library named \"root\" in the content.');\r\n\t\t}\r\n\t\t\r\n\t\treturn this.prepareAsync()\r\n\t\t\t.then(() => {\r\n\t\t\t\treturn new this._piximData.$.lib.root(this._piximData.$);\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Preloads class assets.\r\n\t */\r\n\tpreloadClassAssetAsync(): Promise<void> {\r\n\t\tif (this._piximData.preloadPromise) {\r\n\t\t\treturn this._piximData.preloadPromise;\r\n\t\t}\r\n\t\t\r\n\t\treturn this._piximData.preloadPromise = this._loadAssetAsync(this._piximData.manifests)\r\n\t\t\t.catch((e: IManifestDictionary) => {\r\n\t\t\t\tthis._piximData.preloadPromise = null;\r\n\t\t\t\t\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Preloads instance assets.\r\n\t */\r\n\tpreloadInstanceAssetAsync(): Promise<void> {\r\n\t\tif (this._piximData.postloadPromise) {\r\n\t\t\treturn this._piximData.postloadPromise;\r\n\t\t}\r\n\t\t\r\n\t\treturn this._piximData.postloadPromise = this._loadAssetAsync(this._piximData.additionalManifests)\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis._piximData.postloadPromise = null;\r\n\t\t\t})\r\n\t\t\t.catch((e: IManifestDictionary) => {\r\n\t\t\t\tthis._piximData.postloadPromise = null;\r\n\t\t\t\t\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tprivate _loadAssetAsync(manifests: IContentManifests): Promise<void> {\r\n\t\tconst basepath: string = this._piximData.basepath;\r\n\t\tconst version: IContentAssetVersion = this._piximData.version;\r\n\t\tconst resources: IContentResourceDictionary = this._piximData.$.resources;\r\n\t\t\r\n\t\tconst loaderCount = Object.keys(manifests).length;\r\n\t\t\r\n\t\tif (loaderCount === 0) {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t\t\r\n\t\tconst promises: Promise<IResourceDictionary>[] = [];\r\n\t\tconst keys: TContentManifestType[] = [];\r\n\t\tfor (let i in manifests) {\r\n\t\t\tconst type: TContentManifestType = <TContentManifestType>i;\r\n\t\t\tkeys.push(type);\r\n\t\t\t\r\n\t\t\tpromises.push(manifests[type].getAsync(basepath, version[type] || ''));\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.all(promises)\r\n\t\t\t.then((resolver: IResourceDictionary) => {\r\n\t\t\t\tfor (let i: number = 0; i < resolver.length;i++) {\r\n\t\t\t\t\tresources[keys[i]] = resources[keys[i]] || {};\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let j in resolver[i]) {\r\n\t\t\t\t\t\tresources[keys[i]][j] = resolver[i][j];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((e: IManifestDictionary) => {\r\n\t\t\t\tfor (let i in e) {\r\n\t\t\t\t\tconsole.error(`Asset '${i}: ${e[i]}' cannot load.`);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t}\r\n}"],"names":["Emitter","this","_events","_on","type","callback","once","const","events","i","length","push","on","off","splice","_emit","context","targets","event","let","apply","args","emit","cemit","_emitAll","emitAll","cemitAll","clear","_Emitter","Task","callbacks","_taskData","enabled","index","value","add","prototypeAccessors","Array","isArray","list","Function","done","task","_to","Number","first","prev","next","to","finish","reset","destroy","tasks","super","_piximData","emitter","_Task","Container","taskEnabledChildren","updateTask","e","taskEnabled","PIXI.Container","Layer","taskHandler","obj","children","child","Application","pixiOptions","piximOptions","app","PIXI.Application","stop","view","style","position","autoAdjust","isRun","container","document","body","layers","autoAdjuster","roots","ticker","delta","stage","fullScreen","parentNode","appendChild","_hasLayer","name","addLayer","addChild","removeLayer","removeChild","attachAsync","content","layerName","buildAsync","then","root","detach","contentID","stageOptions","_destroyRoot","play","start","pause","paused","window","removeEventListener","addEventListener","preDestroy","removeView","rect","r","x","y","width","offsetWidth","innerWidth","height","offsetHeight","innerHeight","adjustHeight","toCenter","toTop","adjustWidth","toMiddle","toLeft","w","h","horizontal","hol","left","_getViewRect","toRight","vertical","ver","top","toBottom","parseInt","replace","_cache","ContentManifestBase","manifests","options","unrequired","_manifests","url","getAsync","basepath","version","resources","loadable","cache","manifest","_resolvePath","Object","keys","Promise","resolve","_loadAsync","res","resource","error","path","indexOf","PIXI.utils","ContentImageManifest","reject","loader","PIXI.Loader","defaultQueryString","crossOrigin","load","texture","ContentSpritesheetManifest","textures","ContentSoundManifest","loadedHandler","key","howl","loadedCount","loadCount","Howl","console","warn","_i","match","src","onload","onloaderror","ContentDeliver","data","lib","vars","_contents","_contentID","createManifests","images","spritesheets","sounds","Content","piximData","toString","$","config","additionalManifests","preloadPromise","postloadPromise","create","Error","ContentClone","get","remove","defineManifests","defineImages","defineSpritesheets","defineSounds","setConfig","defineLibraries","addManifests","addImages","addSpritesheets","addSounds","addVars","prepareAsync","preloadClassAssetAsync","preloadInstanceAssetAsync","_loadAssetAsync","catch","promises","all","resolver","j"],"mappings":"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"}