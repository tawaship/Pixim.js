/*!
 * @tawaship/pixim.js - v1.15.0
 * 
 * @require pixi.js v^5.3.2
 * @require howler.js v^2.2.0 (If use sound)
 * @author tawaship (makazu.mori@gmail.com)
 * @license MIT
 */
!function(t,e,r){"use strict";function i(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(r){if("default"!==r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})),e.default=t,Object.freeze(e)}window.console.log("%c pixim.js%cv1.15.0 %c","color: #FFF; background: #03F; padding: 5px; border-radius:12px 0 0 12px; margin-top: 5px; margin-bottom: 5px;","color: #FFF; background: #F33; padding: 5px;  border-radius:0 12px 12px 0;","padding: 5px;");var n=i(e),o=function(){this._events={}};
/*!
 * @tawaship/emitter - v3.1.1
 * 
 * @author tawaship (makazu.mori@gmail.com)
 * @license MIT
 */o.prototype._on=function(t,e,r){if(!t||!e)return this;for(var i=this._events[t]=this._events[t]||[],n=0;n<i.length;n++)if(i[n].callback===e)return this;return i.push({callback:e,once:r}),this},o.prototype.on=function(t,e){return this._on(t,e,!1)},o.prototype.once=function(t,e){return this._on(t,e,!0)},o.prototype.off=function(t,e){if(!t||!e)return this;for(var r=this._events[t]||[],i=0;i<r.length;i++)if(r[i].callback===e)return r.splice(i,1),this;return this},o.prototype._emit=function(t,e){for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];if(!t)return this;for(var n=this._events[t]||[],o=[],a=n.length-1;a>=0;a--){var s=n[a];s.once&&n.splice(a,1),o.push(s)}for(var p=o.length-1;p>=0;p--)o[p].callback.apply(e,r);return this},o.prototype.emit=function(t){for(var e,r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return(e=this)._emit.apply(e,[t,this].concat(r))},o.prototype.cemit=function(t,e){for(var r,i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];return(r=this)._emit.apply(r,[t,e].concat(i))},o.prototype._emitAll=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(null==t)return this;var i=[];for(var n in this._events)for(var o=this._events[n]||[],a=o.length-1;a>=0;a--){var s=o[a];s.once&&o.splice(a,1),i.push(s)}for(var p=i.length-1;p>=0;p--)i[p].callback.apply(t,e);return this},o.prototype.emitAll=function(){for(var t,e=[],r=arguments.length;r--;)e[r]=arguments[r];return(t=this)._emitAll.apply(t,[this].concat(e))},o.prototype.cemitAll=function(t){for(var e,r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return(e=this)._emitAll.apply(e,[t].concat(r))},o.prototype.clear=function(t){return void 0===t&&(t=""),t?delete this._events[t]:this._events={},this};var a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(o),s=function(t,e){this._taskData={context:null==e?this:e,enabled:!0,index:-1,callbacks:[],value:null},this.add(t)},p={enabled:{configurable:!0},value:{configurable:!0}};
/*!
 * @tawaship/task - v1.1.0
 * 
 * @author tawaship (makazu.mori@gmail.com)
 * @license MIT
 */p.enabled.get=function(){return this._taskData.enabled},p.enabled.set=function(t){this._taskData.enabled=t},s.prototype.add=function(t){Array.isArray(t)||(t=[t]);var e=this._taskData.callbacks;e.length;for(var r=0;r<t.length;r++)t[r]instanceof Function&&e.push(t[r]);return this},s.prototype.done=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(this._taskData.enabled){var r=this._taskData.callbacks[this._taskData.index];if(r)return this._taskData.value=r.apply(this._taskData.context,t)}},s.prototype._to=function(t){return this._taskData.index=Number(t),this},s.prototype.first=function(){return this._to(0)},s.prototype.prev=function(){return this._to(this._taskData.index-1)},s.prototype.next=function(){return this._to(this._taskData.index+1)},s.prototype.to=function(t){return this._to(t)},s.prototype.finish=function(){return this._taskData.index=-1,this},s.prototype.reset=function(){return this._taskData.callbacks=[],this._taskData.index=-1,this._taskData.value=null,this},s.prototype.destroy=function(){this.reset()},p.value.get=function(){return this._taskData.value},Object.defineProperties(s.prototype,p);var u=function(t){function e(e,r){t.call(this,e,r),this.enabled=!0,this._piximData={emitter:new a}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(t,e){return this._piximData.emitter.on(t,e),this},e.prototype.once=function(t,e){return this._piximData.emitter.once(t,e),this},e.prototype.off=function(t,e){return this._piximData.emitter.off(t,e),this},e.prototype.emit=function(t){for(var e,r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return this._taskData.enabled?((e=this._piximData.emitter).emit.apply(e,[t].concat(r)),this):this},e.prototype.cemit=function(t,e){for(var r,i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];return this._taskData.enabled?((r=this._piximData.emitter).cemit.apply(r,[t,e].concat(i)),this):this},e.prototype.emitAll=function(){for(var t,e=[],r=arguments.length;r--;)e[r]=arguments[r];return this._taskData.enabled?((t=this._piximData.emitter).emitAll.apply(t,e),this):this},e.prototype.cemitAll=function(t){for(var e,r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return this._taskData.enabled?((e=this._piximData.emitter).cemitAll.apply(e,[t].concat(r)),this):this},e.prototype.clear=function(t){return void 0===t&&(t=""),this._piximData.emitter.clear(t),this},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.clear()},e}(s),c=function(t){function e(){t.call(this),this._piximData={task:new u([],this),taskEnabledChildren:!0},this._piximData.task.first()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={taskEnabled:{configurable:!0},taskEnabledChildren:{configurable:!0},task:{configurable:!0}};return e.prototype.updateTask=function(t){var e=this._piximData.task;this._piximData.task.enabled&&(e.done(t),e.cemitAll(this,t))},r.taskEnabled.get=function(){return this._piximData.task.enabled},r.taskEnabled.set=function(t){this._piximData.task.enabled=t},r.taskEnabledChildren.get=function(){return this._piximData.taskEnabledChildren},r.taskEnabledChildren.set=function(t){this._piximData.taskEnabledChildren=t},r.task.get=function(){return this._piximData.task},e.prototype.destroy=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];t.prototype.destroy.apply(this,e),this._piximData.task.destroy()},Object.defineProperties(e.prototype,r),e}(e.Container),h=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(e.Container);function f(t,r){if(!(t instanceof c)||(t.updateTask(r),t.taskEnabledChildren)){for(var i=[],n=0;n<t.children.length;n++)i.push(t.children[n]);for(var o=0;o<i.length;o++){var a=i[o];a instanceof e.Container&&f(a,r)}}}var d=function(t){function r(r,i){var n=this;void 0===r&&(r={}),void 0===i&&(i={}),t.call(this);var o=new e.Application(r);o.stop(),o.view.style.position="absolute";var a=i.autoAdjust||!1;this._piximData={isRun:!1,app:o,container:i.container||document.body,layers:{},autoAdjuster:null,roots:{},contents:{}},this._piximData.app.ticker.add((function(t){f(n._piximData.app.stage,{delta:t})})),a&&(this.autoAdjuster=!0===a?function(){n.fullScreen()}:function(){a(n)})}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={app:{configurable:!0},stage:{configurable:!0},view:{configurable:!0},container:{configurable:!0},autoAdjuster:{configurable:!0}};return i.app.get=function(){return this._piximData.app},i.stage.get=function(){return this._piximData.app.stage},i.view.get=function(){return this._piximData.app.view},i.container.get=function(){return this._piximData.container},i.container.set=function(t){this._piximData.container=t||document.body,this._piximData.app.view.parentNode&&this._piximData.container.appendChild(this._piximData.app.view)},r.prototype._hasLayer=function(t){return!!this._piximData.layers[t]},r.prototype.addLayer=function(t){return this._hasLayer(t)||(this._piximData.layers[t]=this._piximData.app.stage.addChild(new h)),this},r.prototype.removeLayer=function(t){return this._hasLayer(t)?(this._piximData.app.stage.removeChild(this._piximData.layers[t]),delete this._piximData.layers[t],this):this},r.prototype.attachAsync=function(t,e){var r=this;return void 0===e&&(e="anonymous"),t.buildAsync().then((function(i){return r.detach(t),r.addLayer(e),r._piximData.roots[t.contentID]=i,r._piximData.contents[t.contentID]=t,r._piximData.layers[e].addChild(i),i}))},r.prototype.detach=function(t,e){void 0===e&&(e={children:!0});var r=this._piximData.roots[t.contentID];return r?(this._destroyRoot(r,e),delete this._piximData.roots[t.contentID],delete this._piximData.contents[t.contentID],this):this},r.prototype.play=function(){return this._piximData.container.appendChild(this._piximData.app.view),this.start()},r.prototype.start=function(){return this._piximData.app.start(),this},r.prototype.stop=function(){return this._piximData.app.stop(),this},r.prototype.pause=function(t){return t?this.stop():this.start(),this},i.autoAdjuster.get=function(){return this._piximData.autoAdjuster},i.autoAdjuster.set=function(t){this._piximData.autoAdjuster&&window.removeEventListener("resize",this._piximData.autoAdjuster),t?(this._piximData.autoAdjuster=t,window.addEventListener("resize",t),t()):this._piximData.autoAdjuster=null},r.prototype.preDestroy=function(){for(var t in this._piximData.contents)this._piximData.contents[t].destroy();this.autoAdjuster=null,this._piximData.layers={},this._piximData.roots={},this._piximData.contents={}},r.prototype.destroy=function(t,e){return this.preDestroy(),this._piximData.app.destroy(t,e),this},r.prototype._destroyRoot=function(t,e){t.destroy(e)},r.prototype.fullScreen=function(t){var e=this._piximData.app.view,r=t||{x:0,y:0,width:this._piximData.container.offsetWidth||window.innerWidth,height:this._piximData.container.offsetHeight||window.innerHeight};return r.width/r.height>e.width/e.height?this.adjustHeight(r.height).toCenter(r).toTop(r):this.adjustWidth(r.width).toMiddle(r).toLeft(r)},r.prototype.adjustWidth=function(t){var e=this._piximData.app.view,r=t||this._piximData.container.offsetWidth||window.innerWidth,i=r/e.width*e.height;return e.style.width=r+"px",e.style.height=i+"px",this},r.prototype.adjustHeight=function(t){var e=this._piximData.app.view,r=t||this._piximData.container.offsetHeight||window.innerHeight,i=r/e.height*e.width;return e.style.height=r+"px",e.style.width=i+"px",this},r.prototype.toLeft=function(t){var e=this._piximData.app.view,r=t||{x:0,width:this._piximData.container.offsetWidth||window.innerWidth};return e.style.left=r.x+"px",this},r.prototype.toCenter=function(t){var e=this._piximData.app.view,r=t||{x:0,width:this._piximData.container.offsetWidth||window.innerWidth};return e.style.left=(r.width-this._getViewRect().width)/2+r.x+"px",this},r.prototype.toRight=function(t){var e=this._piximData.app.view,r=t||{x:0,width:this._piximData.container.offsetWidth||window.innerWidth};return e.style.left=r.width-this._getViewRect().width+r.x+"px",this},r.prototype.toTop=function(t){var e=this._piximData.app.view,r=t||{y:0,height:this._piximData.container.offsetHeight||window.innerHeight};return e.style.top=r.y+"px",this},r.prototype.toMiddle=function(t){var e=this._piximData.app.view,r=t||{y:0,height:this._piximData.container.offsetHeight||window.innerHeight};return e.style.top=(r.height-this._getViewRect().height)/2+r.y+"px",this},r.prototype.toBottom=function(t){var e=this._piximData.app.view,r=t||{y:0,height:this._piximData.container.offsetHeight||window.innerHeight};return e.style.top=r.height-this._getViewRect().height+r.y+"px",this},r.prototype._getViewRect=function(){var t=this._piximData.app.view;return{x:parseInt(t.style.left.replace("px","")),y:parseInt(t.style.top.replace("px","")),width:parseInt(t.style.width.replace("px","")),height:parseInt(t.style.height.replace("px",""))}},Object.defineProperties(r.prototype,i),r}(a),l="loaderAssetLoaded",_=function(t){function e(e){t.call(this),this._data={},this._resources={},this._type=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={count:{configurable:!0}};return e.prototype.add=function(t,e){void 0===e&&(e={});var r=e.unrequired||!1;for(var i in t)this._data[i]={target:t[i],unrequired:r}},r.count.get=function(){return Object.keys(this._data).length},e.prototype.getAsync=function(t){var e=this,r={};if(0===Object.keys(this._data).length)return Promise.resolve(r);var i=this._createLoader();i.onLoaded=function(t){e.emit(l,t)};var n,o,a=Object.assign({},t.typeOptions,{basepath:t.basepath,version:t.version,xhr:(n=this._type,o=t.xhr,"function"==typeof o?function(t){return o(n,t)}:o)}),s={};for(var p in this._data)s[p]=this._data[p].target;return i.loadAllAsync(s,a).then((function(t){for(var i in t){var n=t[i];if(n.error&&!e._data[i].unrequired)throw n.error}for(var o in t){var a=t[o];e._resources[o]=a,r[o]=a.data}return r}))},e.prototype.destroyResources=function(){for(var t in this._resources)this._resources[t].destroy()},Object.defineProperties(e.prototype,r),e}(o);function y(t,e,r){if("string"!=typeof e)return e;if(!m(e))return e;r=r||"";var i=v(t=t||"",e);return r?x(i,{_fv:r}):i}function v(t,e){return m(e)?n.utils.url.resolve(t,e):e}function m(t){return 0!==t.indexOf("data:")&&0!==t.indexOf("blob:")}function x(t,e){if(m(t)){var r=[],i=t.split("?");if(i[1])for(var n=i[1].split("&"),o=0;o<n.length;o++){n[o].split("=")[0]in e||r.push(n[o])}for(var a in e)r.push(a+"="+e[a]);return i[0]+"?"+r.join("&")}return t}var g=Object.freeze({__proto__:null,isUrl:m,resolvePath:v,resolveQuery:x,resolveUri:y}),D=function(t,e){this._data=t,this._error=e},w={data:{configurable:!0},error:{configurable:!0}};w.data.get=function(){return this._data},w.error.get=function(){return this._error},Object.defineProperties(D.prototype,w);var b=function(){};b.prototype.loadAsync=function(t,e){var r=this;return r._loadAsync(t,e).then((function(t){return t.error||r.onLoaded&&r.onLoaded(t),t}))},b.prototype.loadAllAsync=function(t,e){var r=this,i={};if(0===Object.keys(t).length)return Promise.resolve(i);var n=[],o=function(o){n.push(r.loadAsync(t[o],e).then((function(t){i[o]=t})))};for(var a in t)o(a);return Promise.all(n).then((function(){return i}))},b.prototype._resolveParams=function(t,e){void 0===e&&(e={});var r=y(e.basepath||"",t,e.version||"");return"string"!=typeof r?{src:r}:m(r)&&e.xhr?!0===e.xhr?{src:r,xhr:{}}:"function"==typeof e.xhr?{src:r,xhr:e.xhr(r)}:{src:r,xhr:e.xhr||{}}:{src:r}};var A=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){(window.URL||window.webkitURL).revokeObjectURL(this._data),this._data=""},e}(D),j=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._loadAsync=function(t,e){var r,i,n;return void 0===e&&(e={}),(r=this._resolveParams(t,e),i=r.src,n=r.xhr,n?fetch(i,n.requestOptions||{}):fetch(i)).then((function(t){if(!t.ok)throw t.statusText;return t.blob()})).then((function(t){return(window.URL||window.webkitURL).createObjectURL(t)})).then((function(t){return new A(t,null)})).catch((function(t){return new A("",t)}))},e}(b),k=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.destroy=function(){this._data&&(r.removeCache(this._data),this._data.destroy(!0),this._data=null)},r.removeCache=function(t){e.Texture.removeFromCache(t),t.baseTexture&&e.BaseTexture.removeFromCache(t.baseTexture)},r}(D),O=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._loadAsync=function(t,r){var i,n,o,a=this;return void 0===r&&(r={}),(i=a._resolveParams(t,r),n=i.src,o=i.xhr,o?(new j).loadAsync(n,{xhr:o}).then((function(t){if(t.error)throw t.error;if(!t.data)throw"invalid resource";return a._loadBaseTextureAsync(t.data)})):a._loadBaseTextureAsync(n)).then((function(t){return new k(new e.Texture(t),null)})).catch((function(t){return new k(null,t)}))},r.prototype._loadBaseTextureAsync=function(t){return(t instanceof HTMLImageElement||t instanceof HTMLVideoElement)&&(t.crossOrigin="anonymous"),new Promise((function(r,i){var n=e.BaseTexture.from(t);if(n.valid)return e.BaseTexture.removeFromCache(n),void r(n);n.on("loaded",(function(t){e.BaseTexture.removeFromCache(t),r(t)})),n.on("error",(function(t,r){e.BaseTexture.removeFromCache(t),i(r)}))}))},r}(b),L=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){this._data=""},e.prototype.ref=function(){document.body.appendChild(document.createElement("script")).text=this._data},e}(D),C=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._loadAsync=function(t,e){var r,i,n;return void 0===e&&(e={}),(r=this._resolveParams(t,e),i=r.src,n=r.xhr,n?fetch(i,n.requestOptions||{}):fetch(i)).then((function(t){if(!t.ok)throw t.statusText;return t.text()})).then((function(t){return new L(t,null)})).catch((function(t){return new L("",t)}))},e}(b),T=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){this._data={}},e}(D),P=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._loadAsync=function(t,e){var r,i,n;return void 0===e&&(e={}),(r=this._resolveParams(t,e),i=r.src,n=r.xhr,n?fetch(i,n.requestOptions):fetch(i)).then((function(t){if(!t.ok)throw t.statusText;return t.json()})).then((function(t){return new T(t,null)})).catch((function(t){return new T({},t)}))},e}(b),R=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){for(var t in this._data)this._data[t].destroy(!0);this._data={}},e}(D),E=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._loadAsync=function(t,e){var r=this;return void 0===e&&(e={}),("string"!=typeof t?r._loadTextureAsync(t,e):r._loadJsonAsync(t,e)).then((function(t){return new R(t,null)})).catch((function(t){return new R({},t)}))},r.prototype._loadJsonAsync=function(t,e){var r=this;return(new P).loadAsync(t,e).then((function(i){if(i.error)throw i.error;if(!i.data)throw"invalid resource";var n=i.data;if(!n.meta||!n.meta.image||!n.frames)throw"invalid json";n.meta.image=y(t,n.meta.image);var o={frames:n.frames,meta:n.meta};return r._loadTextureAsync(o,e)}))},r.prototype._loadTextureAsync=function(t,r){return(new O).loadAsync(t.meta.image,Object.assign({},r,{version:r.textureVersion||r.version})).then((function(r){if(r.error)throw r.error;if(!r.data)throw"invalid resource";var i=new e.Spritesheet(r.data,t);return new Promise((function(t){i.parse((function(e){for(var r in i.textures)k.removeCache(i.textures[r]);t(i.textures)}))}))}))},r}(b),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){this._data&&(this._data.stop(),this._data.unload(),this._data=null)},e}(D),M=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._loadAsync=function(t,e){var i,n,o;return void 0===e&&(e={}),(i=this._resolveParams(t,e),n=i.src,o=i.xhr,new Promise(o?function(t,e){var i=new r.Howl({src:n,onload:function(){t(i)},onloaderror:function(){var t=new Error("invalid resource: "+n);e(t)},xhr:o.requestOptions||{}})}:function(t,e){var i=new r.Howl({src:n,onload:function(){t(i)},onloaderror:function(){var t=new Error("invalid resource: "+n);e(t)}})})).then((function(t){return new H(t,null)})).catch((function(t){return new H(null,t)}))},e}(b),I=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createLoader=function(){return new O},e}(_),S=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createLoader=function(){return new E},e}(_),F=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createLoader=function(){return new M},e}(_),B=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createLoader=function(){return new P},e}(_),W=function(t){this._piximData={width:t.width,height:t.height,lib:t.lib,resources:t.resources,vars:t.vars}},$={width:{configurable:!0},height:{configurable:!0},lib:{configurable:!0},resources:{configurable:!0},vars:{configurable:!0}};$.width.get=function(){return this._piximData.width},$.height.get=function(){return this._piximData.height},$.lib.get=function(){return this._piximData.lib},$.resources.get=function(){return this._piximData.resources},$.vars.get=function(){return this._piximData.vars},Object.defineProperties(W.prototype,$);var J={},V=0;function U(){var t={images:new I("images"),spritesheets:new S("spritesheets"),sounds:new F("sounds"),jsons:new B("jsons")};for(var e in q)t[e]=new q[e](e);return t}var q={images:I,spritesheets:S,sounds:F,jsons:B},z=function(t){function e(r,i){var n=this;void 0===r&&(r={}),void 0===i&&(i=e._piximData),t.call(this),this._loadedResourceHandler=function(t){n.emit(l,t)};var o={width:i.config.width,height:i.config.height,lib:i.lib,resources:{images:{},spritesheets:{},sounds:{},jsons:{}},vars:{}};for(var a in this._piximData={contentID:(++V).toString(),options:r,$:new W(o),manifests:i.manifests,additionalManifests:U(),preloadPromise:null,postloadPromise:null,contentDeliverData:o},this._piximData.manifests)this._piximData.manifests[a].on(l,this._loadedResourceHandler);for(var s in this._piximData.additionalManifests)this._piximData.additionalManifests[s].on(l,this._loadedResourceHandler)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={contentID:{configurable:!0},classAssetCount:{configurable:!0},instanceAssetCount:{configurable:!0},assetCount:{configurable:!0}};return e.registerManifest=function(t,e){q[t]=e},e.create=function(t){if(void 0===t&&(t=""),t&&t in J)throw new Error("Content key '"+t+"' has already exists.");var r=function(t){function e(r){void 0===r&&(r={}),t.call(this,r,e._piximData)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(e);return r._piximData={config:{width:450,height:800},manifests:U(),lib:{}},t?J[t]=r:r},e.get=function(t){return J[t]},e.remove=function(t){delete J[t]},e.defineTargets=function(t,e,r){return void 0===r&&(r={}),this._piximData.manifests[t]?(this._piximData.manifests[t].add(e,r),this):(console.warn("Manifest '"+t+"' is not registered."),this)},e.defineImages=function(t,e){return void 0===e&&(e={}),this.defineTargets("images",t,e)},e.defineSpritesheets=function(t,e){return void 0===e&&(e={}),this.defineTargets("spritesheets",t,e)},e.defineSounds=function(t,e){return void 0===e&&(e={}),this.defineTargets("sounds",t,e)},e.defineJsons=function(t,e){return void 0===e&&(e={}),this.defineTargets("jsons",t,e)},e.setConfig=function(t){return this._piximData.config.width=t.width,this._piximData.config.height=t.height,this},e.defineLibraries=function(t){for(var e in t)this._piximData.lib[e]=t[e];return this},r.contentID.get=function(){return this._piximData.contentID},e.prototype.addTargets=function(t,e,r){return void 0===r&&(r={}),this._piximData.additionalManifests[t]?(this._piximData.additionalManifests[t].add(e,r),this):(console.warn("Manifest '"+t+"' is not registered."),this)},e.prototype.addImages=function(t,e){return void 0===e&&(e={}),this.addTargets("images",t,e)},e.prototype.addSpritesheets=function(t,e){return void 0===e&&(e={}),this.addTargets("spritesheets",t,e)},e.prototype.addSounds=function(t,e){return void 0===e&&(e={}),this.addTargets("sounds",t,e)},e.prototype.addJsons=function(t,e){return void 0===e&&(e={}),this.addTargets("jsons",t,e)},e.prototype.addVars=function(t){for(var e in t)this._piximData.$.vars[e]=t[e];return this},e.prototype.prepareAsync=function(){var t=this;return this.preloadClassAssetAsync().then((function(){return t.preloadInstanceAssetAsync()}))},e.prototype.buildAsync=function(){var t=this;if(!this._piximData.$.lib.root)throw new Error('There is no library named "root" in the content.');return this.prepareAsync().then((function(){return new t._piximData.$.lib.root(t._piximData.$)}))},e.prototype.preloadClassAssetAsync=function(){var t=this;return this._piximData.preloadPromise?this._piximData.preloadPromise:this._piximData.preloadPromise=this._loadAssetAsync(this._piximData.manifests).catch((function(e){throw t._piximData.preloadPromise=null,e}))},e.prototype.preloadInstanceAssetAsync=function(){var t=this;return this._piximData.postloadPromise?this._piximData.postloadPromise:this._piximData.postloadPromise=this._loadAssetAsync(this._piximData.additionalManifests).catch((function(e){throw t._piximData.postloadPromise=null,e}))},e.prototype.destroy=function(){var t=this._piximData.contentDeliverData;t.lib={},t.vars={};var e=this._piximData.manifests,r=this._piximData.additionalManifests;for(var i in e)e[i].off(l,this._loadedResourceHandler);for(var n in r)r[n].off(l,this._loadedResourceHandler);var o=t.resources;for(var a in o)o[a]={}},r.classAssetCount.get=function(){var t=0,e=this._piximData.manifests;for(var r in e)t+=e[r].count;return t},r.instanceAssetCount.get=function(){var t=0,e=this._piximData.additionalManifests;for(var r in e)t+=e[r].count;return t},r.assetCount.get=function(){return this.classAssetCount+this.instanceAssetCount},e.prototype._loadAssetAsync=function(t){if(0===Object.keys(t).length)return Promise.resolve();var e=this._piximData.options,r=function(){if(void 0===e.basepath){var r={};for(var i in t)r[i]="";return r}if("string"==typeof e.basepath){var n={};for(var o in t)n[o]=e.basepath.replace(/(.+[^\/])$/,"$1/");return n}var a={};for(var s in t)a[s]=(e.basepath[s]||"").replace(/(.+[^\/])$/,"$1/");return a}(),i=function(){if(void 0===e.version){var r={};for(var i in t)r[i]="";return r}if("string"==typeof e.version||"number"==typeof e.version){var n={};for(var o in t)n[o]=e.version;return n}var a={};for(var s in t)a[s]=e.version[s]||"";return a}(),n=function(){var r={};for(var i in t)r[i]=e.xhr||!1;return r}(),o=function(){if(void 0===e.typeOptions){var r={};for(var i in t)r[i]={};return r}var n={};for(var o in t)n[o]=e.typeOptions[o]||{};return n}(),a={};for(var s in t)a[s]={basepath:r[s],version:i[s],xhr:n[s],typeOptions:o[s]};var p=this._piximData.$.resources,u=[],c=[];for(var h in t){c.push(h);var f=t[h];u.push(f.getAsync(a[h]))}return Promise.all(u).then((function(t){for(var e=0;e<t.length;e++)for(var r in p[c[e]]=p[c[e]]||{},t[e])p[c[e]][r]=t[e][r]}))},Object.defineProperties(e.prototype,r),e}(o);z.registerManifest("images",I),z.registerManifest("spritesheets",S),z.registerManifest("sounds",F),z.registerManifest("jsons",B),t.Application=d,t.BlobLoader=j,t.BlobLoaderResource=A,t.Container=c,t.Content=z,t.ContentDeliver=W,t.EVENT_LOADER_ASSET_LOADED=l,t.Emitter=a,t.JsLoader=C,t.JsLoaderResource=L,t.JsonLoader=P,t.JsonLoaderResource=T,t.JsonManifest=B,t.Layer=h,t.LoaderBase=b,t.LoaderResource=D,t.ManifestBase=_,t.SoundLoader=M,t.SoundLoaderResource=H,t.SoundManifest=F,t.SpritesheetLoader=E,t.SpritesheetLoaderResource=R,t.SpritesheetManifest=S,t.Task=u,t.TextureLoader=O,t.TextureLoaderResource=k,t.TextureManifest=I,t.utils=g}(this.Pixim=this.Pixim||{},PIXI,{Howl:"undefined"==typeof Howl?null:Howl});//# sourceMappingURL=Pixim.min.js.map
