{"version":3,"file":"Pixim.min.js","sources":["../node_modules/@tawaship/emitter/dist/Emitter.esm.js","../src/modules/Emitter.ts","../node_modules/@tawaship/task/dist/Task.esm.js","../src/modules/Task.ts","../src/modules/Container.ts","../src/modules/Application.ts","../src/modules/content/ManifestBase.ts","../src/modules/utils/index.ts","../src/modules/loader/LoaderBase.ts","../src/modules/loader/BlobLoader.ts","../src/modules/loader/TextureLoader.ts","../src/modules/loader/JsLoader.ts","../src/modules/loader/JsonLoader.ts","../src/modules/loader/SpritesheetLoader.ts","../src/modules/loader/SoundLoader.ts","../src/modules/content/TextureManifest.ts","../src/modules/content/SpritesheetManifest.ts","../src/modules/content/SoundManifest.ts","../src/modules/content/JsonManifest.ts","../src/modules/content/ContentDeliver.ts","../src/modules/content/Content.ts"],"sourcesContent":["/*!\n * @tawaship/emitter - v3.1.1\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Emitter {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    _on(type, callback, once) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ callback, once });\r\n        return this;\r\n    }\r\n    /**\r\n     * Register event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    on(type, callback) {\r\n        return this._on(type, callback, false);\r\n    }\r\n    /**\r\n     * Register one-time event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    once(type, callback) {\r\n        return this._on(type, callback, true);\r\n    }\r\n    /**\r\n     * Unregister event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Registered callback.\r\n     */\r\n    off(type, callback) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                events.splice(i, 1);\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _emit(type, context, ...args) {\r\n        if (!type) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        const targets = [];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            const event = events[i];\r\n            if (event.once) {\r\n                events.splice(i, 1);\r\n            }\r\n            targets.push(event);\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit event.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emit(type, ...args) {\r\n        return this._emit(type, this, ...args);\r\n    }\r\n    /**\r\n     * Emit event with specifying a context.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemit(type, context, ...args) {\r\n        return this._emit(type, context, ...args);\r\n    }\r\n    _emitAll(context, ...args) {\r\n        if (context == null) {\r\n            return this;\r\n        }\r\n        const targets = [];\r\n        for (let type in this._events) {\r\n            const events = this._events[type] || [];\r\n            for (let i = events.length - 1; i >= 0; i--) {\r\n                const event = events[i];\r\n                if (event.once) {\r\n                    events.splice(i, 1);\r\n                }\r\n                targets.push(event);\r\n            }\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit all events.\r\n     *\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emitAll(...args) {\r\n        return this._emitAll(this, ...args);\r\n    }\r\n    /**\r\n     * Emit all events with specifying a context.\r\n     *\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemitAll(context, ...args) {\r\n        return this._emitAll(context, ...args);\r\n    }\r\n    /**\r\n     * Remove events grouped event type.\r\n     *\r\n     * @param type Event type to remove. If it is empty, removes all events.\r\n     */\r\n    clear(type = '') {\r\n        if (type) {\r\n            delete (this._events[type]);\r\n        }\r\n        else {\r\n            this._events = {};\r\n        }\r\n        return this;\r\n    }\r\n}\n\nexport { Emitter };\n//# sourceMappingURL=Emitter.esm.js.map\n","import { Emitter as _Emitter } from '@tawaship/emitter';\r\n\r\n/**\r\n * {@link https://tawaship.github.io/Emitter/index.html | @tawaship/emitter}\r\n */\r\nexport class Emitter extends _Emitter {}","/*!\n * @tawaship/task - v1.1.0\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Task {\r\n    constructor(callbacks, context) {\r\n        this._taskData = {\r\n            context: context == null ? this : context,\r\n            enabled: true,\r\n            index: -1,\r\n            callbacks: [],\r\n            value: null\r\n        };\r\n        this.add(callbacks);\r\n    }\r\n    /**\r\n     * Whether the task works.\r\n     */\r\n    get enabled() {\r\n        return this._taskData.enabled;\r\n    }\r\n    set enabled(enabled) {\r\n        this._taskData.enabled = enabled;\r\n    }\r\n    /**\r\n     * Add the task to the end of the list.\r\n     */\r\n    add(callbacks) {\r\n        if (!Array.isArray(callbacks)) {\r\n            callbacks = [callbacks];\r\n        }\r\n        const list = this._taskData.callbacks;\r\n        const flag = list.length === 0;\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            if (!(callbacks[i] instanceof Function)) {\r\n                continue;\r\n            }\r\n            list.push(callbacks[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Execute the current task.\r\n     */\r\n    done(...args) {\r\n        if (!this._taskData.enabled) {\r\n            return;\r\n        }\r\n        const task = this._taskData.callbacks[this._taskData.index];\r\n        if (!task) {\r\n            return;\r\n        }\r\n        return this._taskData.value = task.apply(this._taskData.context, args);\r\n    }\r\n    _to(index) {\r\n        this._taskData.index = Number(index);\r\n        return this;\r\n    }\r\n    /**\r\n     * Change the current task to the first task.\r\n     */\r\n    first() {\r\n        return this._to(0);\r\n    }\r\n    /**\r\n     * Change the current task to the previos task.\r\n     */\r\n    prev() {\r\n        return this._to(this._taskData.index - 1);\r\n    }\r\n    /**\r\n     * Change the current task to the next task.\r\n     */\r\n    next() {\r\n        return this._to(this._taskData.index + 1);\r\n    }\r\n    /**\r\n     * Change the current task to the specified task.\r\n     */\r\n    to(index) {\r\n        return this._to(index);\r\n    }\r\n    /**\r\n     * Skips all tasks and changes to the finished state.\r\n     */\r\n    finish() {\r\n        this._taskData.index = -1;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancel all task and leave them unregistered.\r\n     */\r\n    reset() {\r\n        this._taskData.callbacks = [];\r\n        this._taskData.index = -1;\r\n        this._taskData.value = null;\r\n        return this;\r\n    }\r\n    /**\r\n     * Destroy instance.\r\n     */\r\n    destroy() {\r\n        this.reset();\r\n    }\r\n    /**\r\n     * The value returned by the last task executed.\r\n     */\r\n    get value() {\r\n        return this._taskData.value;\r\n    }\r\n}\n\nexport { Task };\n//# sourceMappingURL=Task.esm.js.map\n","import { ITickerData } from './Application';\r\nimport { Emitter } from './Emitter';\r\nimport { Task as _Task } from '@tawaship/task';\r\n\r\nexport interface ITaskData {\r\n\temitter: Emitter\r\n}\r\n\r\nexport interface ITaskDelegate {\r\n    (e: ITickerData): void;\r\n}\r\n\r\n/**\r\n * {@link https://tawaship.github.io/Task/index.html | @tawaship/task}\r\n */\r\nexport class Task extends _Task {\r\n\tprivate _piximData: ITaskData;\r\n\t\r\n\tconstructor(tasks: ITaskDelegate | ITaskDelegate[], context: any) {\r\n\t\tsuper(tasks, context);\r\n\t\t\r\n\t\tthis.enabled = true;\r\n\t\tthis._piximData = {\r\n\t\t\temitter: new Emitter()\r\n\t\t};\r\n\t}\r\n\t\r\n\ton(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.on(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tonce(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.once(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\toff(type: string, callback: ITaskDelegate) {\r\n\t\tthis._piximData.emitter.off(type, callback);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\temit(type: string, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.emit(type, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tcemit(type: string, context: any, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.cemit(type, context, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\temitAll(...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.emitAll(...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tcemitAll(context: any, ...args: any[]) {\r\n\t\tif (!this._taskData.enabled) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.emitter.cemitAll(context, ...args);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tclear(type: string = '') {\r\n\t\tthis._piximData.emitter.clear(type);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tdestroy() {\r\n\t\tsuper.destroy();\r\n\t\tthis.clear();\r\n\t}\r\n}","import { Container as PixiContainer } from 'pixi.js';\r\nimport { Task } from './Task';\r\nimport { ITickerData } from './Application';\r\n\r\nexport interface IContainerData {\r\n\ttask: Task,\r\n\ttaskEnabledChildren: boolean\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nlet _lastObserverID = 0;\r\n\r\n/**\r\n * {@link https://pixijs.download/v5.3.2/docs/docs/PIXI.Container.html}\r\n */\r\nexport class Container extends PixiContainer {\r\n\tprotected _piximData: IContainerData;\r\n\t\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\ttask: new Task([], this),\r\n\t\t\ttaskEnabledChildren: true\r\n\t\t};\r\n\t\t\r\n\t\tthis._piximData.task.first();\r\n\t\t\r\n\t\tconst _observerID = _lastObserverID++;\r\n\t\t/*\r\n\t\tthis.on('added', () => {\r\n\t\t\tTaskManager.addObserver(_observerID, this);\r\n\t\t});\r\n\t\t\r\n\t\tthis.on('removed', () => {\r\n\t\t\tTaskManager.removeObserver(_observerID);\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\t\r\n\tupdateTask(e: ITickerData) {\r\n\t\tconst task: Task = this._piximData.task;\r\n\t\t\r\n\t\tif (!this._piximData.task.enabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tlet p: PIXI.DisplayObject = this;\r\n\t\tlet f = true;\r\n\t\t\r\n\t\twhile (p) {\r\n\t\t\tif (p instanceof Container && !p.taskEnabledChildren) {\r\n\t\t\t\tf = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tp = p.parent;\r\n\t\t}\r\n\t\t\r\n\t\tif (!f) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\ttask.done(e);\r\n\t\t\r\n\t\ttask.cemitAll(this, e);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether the task works.\r\n\t */\r\n\tget taskEnabled(): boolean {\r\n\t\treturn this._piximData.task.enabled;\r\n\t}\r\n\t\r\n\tset taskEnabled(enabled) {\r\n\t\tthis._piximData.task.enabled = enabled;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether the children and subsequent tasks work.\r\n\t */\r\n\tget taskEnabledChildren(): boolean {\r\n\t\treturn this._piximData.taskEnabledChildren;\r\n\t}\r\n\t\r\n\tset taskEnabledChildren(enabled) {\r\n\t\tthis._piximData.taskEnabledChildren = enabled;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Task object that works only while it is being displayed.\r\n\t */\r\n\tget task(): Task {\r\n\t\treturn this._piximData.task;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Destroy instance.\r\n\t * \r\n\t * @override\r\n\t */\r\n\tdestroy(...args: any[]): void {\r\n\t\tsuper.destroy(...args);\r\n\t\tthis._piximData.task.destroy();\r\n\t}\r\n}","import { DisplayObject, Application as PixiApplication, Container as PixiContainer, Ticker } from \"pixi.js\";\r\nimport { Content } from './content/Content';\r\nimport { Container } from './Container';\r\nimport { Emitter } from './Emitter';\r\n//import { TaskManager } from './TaskManager';\r\n\r\nexport interface IContentDictionary {\r\n\t[id: string]: Content;\r\n}\r\n\r\nexport interface IRootDictionary {\r\n\t[id: string]: PixiContainer;\r\n}\r\n\r\nexport interface ILayerDictionary{\r\n\t[name: string]: Layer;\r\n}\r\n\r\nexport interface ITickerData {\r\n\tdelta: number\r\n}\r\n\r\nexport interface IAdjustDelegate {\r\n\t(app: Application): void;\r\n}\r\n\r\nexport type TAutoAdjust = boolean | IAdjustDelegate;\r\n\r\nexport interface IAutoAdjustDelegate {\r\n\t(): void;\r\n}\r\n\r\nexport type TAutoAdjuster = IAutoAdjustDelegate | null;\r\n\r\nexport interface IApplicationOption {\r\n\t/**\r\n\t * Parent node of canvas element.\r\n\t */\r\n\tcontainer?: HTMLElement;\r\n\t\r\n\t/**\r\n\t * Whether to automatically resize the canvas when resizing the window.<br />\r\n\t * Or the resizing process to be executed at that time.\r\n\t */\r\n\tautoAdjust?: TAutoAdjust;\r\n}\r\n\r\nexport interface IApplicationData {\r\n\tisRun: boolean;\r\n\t/**\r\n\t * {@link https://pixijs.download/v5.3.2/docs/PIXI.Application.html | PixiApplication}\r\n\t */\r\n\tapp: PixiApplication;\r\n\tcontainer: HTMLElement;\r\n\tlayers: ILayerDictionary;\r\n\tautoAdjuster: TAutoAdjuster;\r\n\troots: IRootDictionary;\r\n\tcontents: IContentDictionary;\r\n}\r\n\r\nexport interface ISize {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IPosition {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport interface IHorizontal {\r\n\tx: number;\r\n\twidth: number;\r\n}\r\n\r\nexport interface IVertical {\r\n\ty: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IRect extends ISize, IPosition {}\r\n\r\nexport interface IDestroyOptions {\r\n\tchildren?: boolean;\r\n\ttexture?: boolean;\r\n\tbaseTexture?: boolean;\r\n}\r\n\r\nexport class Layer extends PixiContainer {}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction taskHandler(obj: PixiContainer, e: ITickerData): void {\r\n\tif (obj instanceof Container) {\r\n\t\tobj.updateTask(e);\r\n\t\t\r\n\t\tif (!obj.taskEnabledChildren) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst children: DisplayObject[] = [];\r\n\t\r\n\tfor (let i = 0; i < obj.children.length; i++) {\r\n\t\tchildren.push(obj.children[i]);\r\n\t}\r\n\t\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tconst child = children[i];\r\n\t\t\r\n\t\tif (child instanceof PixiContainer) {\r\n\t\t\ttaskHandler(child, e);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Application extends Emitter {\r\n\tprotected _piximData: IApplicationData;\r\n\t\r\n\t/**\r\n\t * @param pixiOptions Optional data for {@link https://pixijs.download/v5.3.2/docs/PIXI.Application.html | PixiApplication} constructor.\r\n\t * @param piximOptions Optional data for Pixim.\r\n\t */\r\n\tconstructor(pixiOptions: Object = {}, piximOptions: IApplicationOption = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tconst app: PixiApplication = new PixiApplication(pixiOptions);\r\n\t\tapp.stop();\r\n\t\t\r\n\t\tapp.view.style.position = 'absolute';\r\n\t\t\r\n\t\tconst autoAdjust: TAutoAdjust = piximOptions.autoAdjust || false;\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\tisRun: false,\r\n\t\t\tapp,\r\n\t\t\tcontainer: piximOptions.container || document.body,\r\n\t\t\tlayers: {},\r\n\t\t\tautoAdjuster: null,\r\n\t\t\troots: {},\r\n\t\t\tcontents: {}\r\n\t\t};\r\n\t\t\r\n\t\tconst ticker: Ticker = this._piximData.app.ticker;\r\n\t\t\r\n\t\tticker.add((delta: number) => {\r\n\t\t\t//TaskManager.done({ delta });\r\n\t\t\ttaskHandler(this._piximData.app.stage, { delta });\r\n\t\t});\r\n\t\t\r\n\t\tif (autoAdjust) {\r\n\t\t\tif (autoAdjust === true) {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tthis.fullScreen()\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tautoAdjust(this);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tget app(): PixiApplication {\r\n\t\treturn this._piximData.app;\r\n\t}\r\n\t\r\n\tget stage(): PixiContainer {\r\n\t\treturn this._piximData.app.stage;\r\n\t}\r\n\t\r\n\tget view(): HTMLCanvasElement {\r\n\t\treturn this._piximData.app.view;\r\n\t}\r\n\t\r\n\tget container(): HTMLElement {\r\n\t\treturn this._piximData.container;\r\n\t}\r\n\t\r\n\tset container(container: HTMLElement) {\r\n\t\tthis._piximData.container = container || document.body;\r\n\t\tif (this._piximData.app.view.parentNode) {\r\n\t\t\tthis._piximData.container.appendChild(this._piximData.app.view);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Whether application has layer.\r\n\t */\r\n\tprivate _hasLayer(name: string): boolean {\r\n\t\treturn !!this._piximData.layers[name];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Add layer to application.\r\n\t */\r\n\taddLayer(name: string) {\r\n\t\tif (this._hasLayer(name)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.layers[name] = this._piximData.app.stage.addChild(new Layer());\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove layer form application.\r\n\t */\r\n\tremoveLayer(name: string) {\r\n\t\tif (!this._hasLayer(name)) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.app.stage.removeChild(this._piximData.layers[name]);\r\n\t\tdelete(this._piximData.layers[name]);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Attach content to application.\r\n\t */\r\n\tattachAsync(content: Content, layerName: string = 'anonymous'): Promise<PixiContainer> {\r\n\t\treturn content.buildAsync()\r\n\t\t\t.then((root: PixiContainer) => {\r\n\t\t\t\tthis.detach(content);\r\n\t\t\t\t\r\n\t\t\t\tthis.addLayer(layerName);\r\n\t\t\t\t\r\n\t\t\t\tthis._piximData.roots[content.contentID] = root;\r\n\t\t\t\tthis._piximData.contents[content.contentID] = content;\r\n\t\t\t\tthis._piximData.layers[layerName].addChild(root);\r\n\t\t\t\t\r\n\t\t\t\treturn root;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Detach content from application.\r\n\t */\r\n\tdetach(content: Content, stageOptions: IDestroyOptions = { children: true }) {\r\n\t\tconst root: PixiContainer = this._piximData.roots[content.contentID];\r\n\t\t\r\n\t\tif (!root) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._destroyRoot(root, stageOptions);\r\n\t\tdelete(this._piximData.roots[content.contentID]);\r\n\t\tdelete(this._piximData.contents[content.contentID]);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Start application and displa viewy.\r\n\t */\r\n\tplay() {\r\n\t\tthis._piximData.container.appendChild(this._piximData.app.view);\r\n\t\t\r\n\t\treturn this.start();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Start application.\r\n\t */\r\n\tstart() {\r\n\t\tthis._piximData.app.start();\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Stop application.\r\n\t */\r\n\tstop() {\r\n\t\tthis._piximData.app.stop();\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Pause (or restart) application.\r\n\t */\r\n\tpause(paused: boolean) {\r\n\t\tif (paused) {\r\n\t\t\tthis.stop();\r\n\t\t} else {\r\n\t\t\tthis.start();\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tget autoAdjuster() {\r\n\t\treturn this._piximData.autoAdjuster;\r\n\t}\r\n\t\r\n\tset autoAdjuster(autoAdjuster: TAutoAdjuster) {\r\n\t\tif (this._piximData.autoAdjuster) {\r\n\t\t\twindow.removeEventListener('resize', this._piximData.autoAdjuster);\r\n\t\t}\r\n\t\t\r\n\t\tif (!autoAdjuster) {\r\n\t\t\tthis._piximData.autoAdjuster = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.autoAdjuster = autoAdjuster;\r\n\t\twindow.addEventListener('resize', autoAdjuster);\r\n\t\tautoAdjuster();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Pre process to destroy application.\r\n\t */\r\n\tpreDestroy() {\r\n\t\tfor (let i in this._piximData.contents) {\r\n\t\t\tthis._piximData.contents[i].destroy();\r\n\t\t}\r\n\t\t\r\n\t\tthis.autoAdjuster = null;\r\n\t\tthis._piximData.layers = {};\r\n\t\tthis._piximData.roots = {};\r\n\t\tthis._piximData.contents = {};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Destroy application.\r\n\t */\r\n\tdestroy(removeView?: boolean, stageOptions?: IDestroyOptions) {\r\n\t\tthis.preDestroy();\r\n\t\t\r\n\t\tthis._piximData.app.destroy(removeView, stageOptions);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _destroyRoot(root: PixiContainer, stageOptions?: IDestroyOptions): void {\r\n\t\troot.destroy(stageOptions);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified rectangle.\r\n\t * \r\n\t * @param rect Rectangle to adjust.\r\n\t */\r\n\tfullScreen(rect?: IRect) {\r\n\t\tconst view: HTMLCanvasElement = this._piximData.app.view;\r\n\t\tconst r: IRect = rect || {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tif (r.width / r.height > view.width / view.height) {\r\n\t\t\treturn this.adjustHeight(r.height).toCenter(r).toTop(r);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.adjustWidth(r.width).toMiddle(r).toLeft(r);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified width.\r\n\t * \r\n\t * @param width Width to adjust.\r\n\t */\r\n\tadjustWidth(width?: number) {\r\n\t\tconst view: HTMLCanvasElement = this._piximData.app.view;\r\n\t\tconst w: number = width || this._piximData.container.offsetWidth || window.innerWidth;\r\n\t\t\r\n\t\tconst h: number = w / view.width * view.height;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.width = `${w}px`;\r\n\t\tview.style.height = `${h}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified height.\r\n\t * \r\n\t * @param height Height to adjust.\r\n\t */\r\n\tadjustHeight(height?: number) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst h: number = height || this._piximData.container.offsetHeight || window.innerHeight;\r\n\t\t\r\n\t\tconst w = h / view.height * view.width;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.height = `${h}px`;\r\n\t\tview.style.width = `${w}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Left justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoLeft(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Center justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoCenter(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${(hol.width - this._getViewRect().width) / 2 + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Right justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoRight(horizontal?: IHorizontal) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._piximData.container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.width - this._getViewRect().width + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Top justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoTop(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Middle justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoMiddle(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${(ver.height - this._getViewRect().height) / 2 + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Bottom justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoBottom(vertical?: IVertical) {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._piximData.container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.height - this._getViewRect().height + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _getViewRect(): IRect {\r\n\t\tconst view = this._piximData.app.view;\r\n\t\t\r\n\t\treturn {\r\n\t\t\tx: parseInt(view.style.left.replace('px', '')),\r\n\t\t\ty: parseInt(view.style.top.replace('px', '')),\r\n\t\t\twidth: parseInt(view.style.width.replace('px', '')),\r\n\t\t\theight: parseInt(view.style.height.replace('px', ''))\r\n\t\t};\r\n\t}\r\n}","import { Emitter } from '@tawaship/emitter';\r\nimport { ILoaderOption, ILoaderXhrOption, LoaderBase, LoaderResource, TLoaderResourceVersion } from '../loader';\r\n\r\nexport interface IManifestClass<TTarget, TRawResource, TResource extends LoaderResource<TRawResource>> {\r\n\tnew(type: string): ManifestBase<TTarget, TRawResource, TResource>;\r\n}\r\n\r\nexport interface IResourceManagerData<T> {\r\n\ttarget: T;\r\n\tunrequired: boolean;\r\n}\r\n\r\nexport interface IResourceManagerManifest<T> {\r\n\t[ name: string ]: IResourceManagerData<T>;\r\n}\r\n\r\nexport interface IManifestOption {\r\n\tunrequired?: boolean;\r\n}\r\n\r\nexport type TManifestResourceVersion = TLoaderResourceVersion;\r\n\r\nexport interface IManifestLoaderXhrOptionFacotryDelegate {\r\n\t(type: string, url: string): ILoaderXhrOption;\r\n}\r\n\r\nexport type TManifestLoaderXhrOption = IManifestLoaderXhrOptionFacotryDelegate | boolean | ILoaderXhrOption;\r\n\r\nexport interface IManifestLoaderOption {\r\n\tbasepath: string;\r\n\tversion: TManifestResourceVersion;\r\n\txhr: TManifestLoaderXhrOption;\r\n\ttypeOptions: ILoaderOption;\r\n}\r\n\r\nexport const EVENT_LOADER_ASSET_LOADED = 'loaderAssetLoaded';\r\n\r\nexport abstract class ManifestBase<TTarget, TRawResource, TResource extends LoaderResource<TRawResource>> extends Emitter {\r\n\tprotected _data: IResourceManagerManifest<TTarget> = {};\r\n\tprotected _resources: Record<string, TResource> = {};\r\n\tprivate _type: string;\r\n\t\r\n\tconstructor(type: string) {\r\n\t\tsuper();\r\n\t\tthis._type = type;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Register targetss.\r\n\t */\r\n\tadd(targets: Record<string, TTarget>, options: IManifestOption = {}): void {\r\n\t\tconst unrequired = options.unrequired || false;\r\n\t\t\r\n\t\tfor (let i in targets) {\r\n\t\t\tthis._data[i] = {\r\n\t\t\t\ttarget: targets[i],\r\n\t\t\t\tunrequired\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tget count() {\r\n\t\treturn Object.keys(this._data).length;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get resources.\r\n\t */\r\n\tgetAsync(options: IManifestLoaderOption) {\r\n        const res: Record<string, TRawResource> = {};\r\n\r\n\t\tif (Object.keys(this._data).length === 0) {\r\n\t\t\treturn Promise.resolve(res);\r\n\t\t}\r\n\t\t\r\n\t\tconst loader = this._createLoader();\r\n\t\tloader.onLoaded = (resource: TResource) => {\r\n\t\t\tthis.emit(EVENT_LOADER_ASSET_LOADED, resource);\r\n\t\t};\r\n\t\t\r\n\t\tconst loaderOptions: ILoaderOption = Object.assign({}, options.typeOptions, {\r\n\t\t\tbasepath: options.basepath,\r\n\t\t\tversion: options.version,\r\n\t\t\txhr: ((type: string, xhr: TManifestLoaderXhrOption) => {\r\n\t\t\t\tif (typeof(xhr) === 'function') {\r\n\t\t\t\t\treturn (url: string) => {\r\n\t\t\t\t\t\treturn xhr(type, url);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn xhr;\r\n\t\t\t})(this._type, options.xhr)\r\n\t\t});\r\n\t\t\r\n\t\tconst data: Record<string, TTarget> = {};\r\n\t\t\r\n\t\tfor (let i in this._data) {\r\n\t\t\tdata[i] = this._data[i].target;\r\n\t\t}\r\n\t\t\r\n\t\treturn loader.loadAllAsync(data, loaderOptions)\r\n\t\t\t.then(resources => {\r\n\t\t\t\tfor (let i in resources) {\r\n\t\t\t\t\tconst resource = resources[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (resource.error && !this._data[i].unrequired) {\r\n\t\t\t\t\t\tthrow resource.error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (let i in resources) {\r\n\t\t\t\t\tconst resource = resources[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._resources[i] = resource;\r\n\t\t\t\t\tres[i] = resource.data;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn res;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tprotected abstract _createLoader(): LoaderBase<TTarget, TRawResource, TResource>;\r\n\t\r\n\tdestroyResources() {\r\n\t\tfor (let i in this._resources) {\r\n\t\t\tthis._resources[i].destroy();\r\n\t\t}\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\n\r\nexport function resolveUri(basepath: string, uri: any, version?: string | number) {\r\n\tif (typeof(uri) !== 'string') {\r\n\t\treturn uri;\r\n\t}\r\n\t\t\r\n\tif (!isUrl(uri)) {\r\n\t\treturn uri;\r\n\t}\r\n\t\r\n\tbasepath = basepath || '';\r\n\tversion = version || '';\r\n\tconst preUri = resolvePath(basepath, uri);\r\n\t\r\n\treturn version ? resolveQuery(preUri, { _fv: version }) : preUri;\r\n}\r\n\r\n\r\nexport function resolvePath(basepath: string, path: string) {\r\n\tif (!isUrl(path)) {\r\n\t\treturn path;\r\n\t}\r\n\t\r\n\treturn PIXI.utils.url.resolve(basepath, path);\r\n}\r\n\r\nexport function isUrl(uri: any) {\r\n\tif (uri.indexOf('data:') === 0) {\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tif (uri.indexOf('blob:') === 0) {\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\treturn true;\r\n}\r\n\r\nexport function resolveQuery(uri: string, queries: { [ name: string ]: any }): string {\r\n\tif (!isUrl(uri)) {\r\n\t\treturn uri;\r\n\t} else {\r\n\t\tconst q: string[] = [];\r\n\t\t\r\n\t\tconst t = uri.split('?');\r\n\t\t\r\n\t\tif (t[1]) {\r\n\t\t\tconst search = t[1].split('&');\r\n\t\t\tfor (let i = 0; i < search.length; i++) {\r\n\t\t\t\tconst p = search[i].split('=');\r\n\t\t\t\tif (!(p[0] in queries)) {\r\n\t\t\t\t\tq.push(search[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (let i in queries) {\r\n\t\t\tq.push(`${i}=${queries[i]}`);\r\n\t\t}\r\n\t\t\r\n\t\treturn `${t[0]}?${q.join('&')}`;\r\n\t}\r\n}","import * as PIXI from 'pixi.js';\r\nimport * as utils from '../utils/index';\r\n\r\nexport abstract class LoaderResource<T> {\r\n\tprotected _data: T;\r\n\tprotected _error: any;\r\n\t\r\n\tconstructor(data: T, error: any) {\r\n\t\tthis._data = data;\r\n\t\tthis._error = error;\r\n\t}\r\n\t\r\n\tabstract destroy(): void;\r\n\t\r\n\tget data() {\r\n\t\treturn this._data;\r\n\t}\r\n\t\r\n\tget error() {\r\n\t\treturn this._error;\r\n\t}\r\n}\r\n\r\nexport interface IFetchRequestOption {\r\n\t[key: string]: string;\r\n}\r\n\r\nexport interface ILoaderXhrOption {\r\n\trequestOptions?: IFetchRequestOption;\r\n}\r\n\r\nexport interface ILoaderResolvedParam {\r\n\tsrc: string;\r\n\txhr?: ILoaderXhrOption;\r\n}\r\n\r\nexport interface ILoaderXhrOptionFacotryDelegate {\r\n\t(url: string): ILoaderXhrOption;\r\n}\r\n\r\nexport type TLoaderResourceVersion = string | number;\r\n\r\nexport interface ILoaderOption {\r\n\tbasepath?: string;\r\n\tversion?: TLoaderResourceVersion;\r\n\txhr?: ILoaderXhrOption | boolean | ILoaderXhrOptionFacotryDelegate;\r\n}\r\n\r\n\r\nexport abstract class LoaderBase<TTarget, TRawResource, TResource extends LoaderResource<TRawResource>> {\r\n\t/**\r\n\t * Callback when one of the resources has succeeded loading.\r\n\t */\r\n\tonLoaded?: (resource: TResource) => void;\r\n\t\r\n\tloadAsync(target: TTarget, options?: ILoaderOption) {\r\n\t\treturn (() => {\r\n\t\t\treturn this._loadAsync(target, options);\r\n\t\t})()\r\n\t\t.then(resource => {\r\n\t\t\tif (!resource.error) {\r\n\t\t\t\tthis.onLoaded && this.onLoaded(resource);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn resource;\r\n\t\t});\r\n\t}\r\n\t\r\n\tprotected abstract _loadAsync(target: TTarget, options?: ILoaderOption): Promise<TResource>;\r\n\t\r\n\tloadAllAsync(targets: Record<string, TTarget>, options?: ILoaderOption) {\r\n\t\tconst res: Record<string, TResource> = {};\r\n\t\t\r\n\t\tif (Object.keys(targets).length === 0) {\r\n\t\t\treturn Promise.resolve(res);\r\n\t\t}\r\n\t\t\r\n\t\tconst promises: Promise<void>[] = [];\r\n\t\t\r\n\t\tfor (let i in targets) {\r\n\t\t\tpromises.push(\r\n\t\t\t\tthis.loadAsync(targets[i], options)\r\n\t\t\t\t\t.then(resource => {\r\n\t\t\t\t\t\tres[i] = resource;\r\n\t\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.all(promises)\r\n\t\t\t.then(() => {\r\n\t\t\t\treturn res;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tprotected _resolveParams(target: any, options: ILoaderOption = {}): ILoaderResolvedParam {\r\n\t\tconst src = utils.resolveUri(options.basepath || '', target, options.version || '');\r\n\t\t\r\n\t\tif (typeof(src) !== 'string') {\r\n\t\t\treturn {\r\n\t\t\t\tsrc\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tif (!utils.isUrl(src)) {\r\n\t\t\treturn {\r\n\t\t\t\tsrc\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tif (!options.xhr) {\r\n\t\t\treturn {\r\n\t\t\t\tsrc\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tif (options.xhr === true) {\r\n\t\t\treturn {\r\n\t\t\t\tsrc,\r\n\t\t\t\txhr: {}\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof(options.xhr) === 'function') {\r\n\t\t\treturn {\r\n\t\t\t\tsrc,\r\n\t\t\t\txhr: options.xhr(src)\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\tsrc,\r\n\t\t\txhr: options.xhr || {}\r\n\t\t};\r\n\t}\r\n}","import { ILoaderOption, LoaderBase, LoaderResource } from \"./LoaderBase\";\r\n\r\nexport type TBlobLoaderRawResource = string;\r\n\r\nexport class BlobLoaderResource extends LoaderResource<TBlobLoaderRawResource> {\r\n\tdestroy() {\r\n\t\t(window.URL || window.webkitURL).revokeObjectURL(this._data);\r\n\t\tthis._data = '';\r\n\t}\r\n}\r\n\r\nexport type TBlobLoaderTarget = string;\r\n\r\nexport interface IBlobLoaderOption extends ILoaderOption {\r\n\r\n}\r\n\r\nexport class BlobLoader extends LoaderBase<TBlobLoaderTarget, TBlobLoaderRawResource, BlobLoaderResource> {\r\n\tprotected _loadAsync(target: TBlobLoaderTarget, options: IBlobLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tconst data = this._resolveParams(target, options);\r\n\t\t\tconst src = data.src;\r\n\t\t\tconst xhr = data.xhr;\r\n\t\t\t\r\n\t\t\tif (!xhr) {\r\n\t\t\t\treturn fetch(src);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn fetch(src, xhr.requestOptions || {});\r\n\t\t})()\r\n\t\t.then(res => {\r\n\t\t\tif (!res.ok) {\r\n\t\t\t\tthrow res.statusText;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn res.blob();\r\n\t\t})\r\n\t\t.then(blob => {\r\n\t\t\treturn (window.URL || window.webkitURL).createObjectURL(blob);\r\n\t\t})\r\n\t\t.then(uri => new BlobLoaderResource(uri, null))\r\n\t\t.catch((e: any) => new BlobLoaderResource('', e));\r\n\t}\r\n}","import { BaseTexture, Texture } from 'pixi.js';\r\nimport { BlobLoader } from './BlobLoader';\r\nimport { ILoaderOption, LoaderBase, LoaderResource } from './LoaderBase';\r\n\r\nexport type TTextureLoaderRawResource = Texture | null;\r\n\r\nexport class TextureLoaderResource extends LoaderResource<TTextureLoaderRawResource> {\r\n\tdestroy() {\r\n\t\tif (this._data) {\r\n\t\t\tTextureLoaderResource.removeCache(this._data);\r\n\t\t\tthis._data.destroy(true);\r\n\t\t\tthis._data = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic removeCache(texture: Texture) {\r\n\t\tTexture.removeFromCache(texture);\r\n        \r\n\t\tif (texture.baseTexture) {\r\n\t\t\tBaseTexture.removeFromCache(texture.baseTexture);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport type TTextureLoaderElementTarget = HTMLImageElement | HTMLVideoElement;\r\n\r\nexport type TTextureLoaderTarget = string | TTextureLoaderElementTarget;\r\n\r\nexport interface ITextureLoaderOption extends ILoaderOption {\r\n\r\n}\r\n\r\nexport class TextureLoader extends LoaderBase<TTextureLoaderTarget, TTextureLoaderRawResource, TextureLoaderResource> {\r\n\tprotected _loadAsync(target: TTextureLoaderTarget, options: ITextureLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tconst data = this._resolveParams(target, options);\r\n\t\t\tconst src = data.src;\r\n\t\t\tconst xhr = data.xhr;\r\n\t\t\t\r\n\t\t\tif (!xhr) {\r\n\t\t\t\treturn this._loadBaseTextureAsync(src);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst loader = new BlobLoader();\r\n\t\t\t\r\n\t\t\treturn loader.loadAsync(src, { xhr })\r\n\t\t\t\t.then(resource => {\r\n\t\t\t\t\tif (resource.error) {\r\n\t\t\t\t\t\tthrow resource.error;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!resource.data) {\r\n\t\t\t\t\t\tthrow 'invalid resource';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn this._loadBaseTextureAsync(resource.data);\r\n\t\t\t\t});\r\n\t\t})()\r\n\t\t.then(baseTexture => new TextureLoaderResource(new Texture(baseTexture), null))\r\n\t\t.catch(e => new TextureLoaderResource(null, e));\r\n\t}\r\n\t\r\n\tprivate _loadBaseTextureAsync(target: TTextureLoaderTarget) {\r\n\t\tif (target instanceof HTMLImageElement || target instanceof HTMLVideoElement) {\r\n\t\t\ttarget.crossOrigin = 'anonymous';\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise<BaseTexture>((resolve, reject) => {\r\n\t\t\tconst bt = BaseTexture.from(target);\r\n\t\t\t\r\n\t\t\tif (bt.valid) {\r\n\t\t\t\tBaseTexture.removeFromCache(bt);\r\n\t\t\t\tresolve(bt);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tbt.on('loaded', (baseTexture: BaseTexture) => {\r\n\t\t\t\tBaseTexture.removeFromCache(baseTexture);\r\n\t\t\t\tresolve(baseTexture);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tbt.on('error', (baseTexture: BaseTexture, e: Error) => {\r\n\t\t\t\tBaseTexture.removeFromCache(baseTexture);\r\n\t\t\t\treject(e);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}","import { ILoaderOption, LoaderBase, LoaderResource } from \"./LoaderBase\";\r\n\r\nexport type TJsLoaderRawResource = string;\r\n\r\nexport class JsLoaderResource extends LoaderResource<TJsLoaderRawResource> {\r\n\tdestroy() {\r\n\t\tthis._data = '';\r\n\t}\r\n\t\r\n\tref() {\r\n\t\tconst script = document.body.appendChild(document.createElement('script'));\r\n\t\tscript.text = this._data;\r\n\t}\r\n}\r\n\r\nexport type TJsLoaderTarget = string;\r\n\r\nexport interface IJsLoaderOption extends ILoaderOption {\r\n\r\n}\r\n\r\nexport class JsLoader extends LoaderBase<TJsLoaderTarget, TJsLoaderRawResource, JsLoaderResource> {\r\n\tprotected _loadAsync(target: TJsLoaderTarget, options: IJsLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tconst data = this._resolveParams(target, options);\r\n\t\t\tconst src = data.src;\r\n\t\t\tconst xhr = data.xhr;\r\n\t\t\t\r\n\t\t\tif (!xhr) {\r\n\t\t\t\treturn fetch(src);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn fetch(src, xhr.requestOptions || {});\r\n\t\t})()\r\n\t\t.then(res => {\r\n\t\t\tif (!res.ok) {\r\n\t\t\t\tthrow res.statusText;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn res.text();\r\n\t\t})\r\n\t\t.then(text => new JsLoaderResource(text, null))\r\n\t\t.catch((e: any) => new JsLoaderResource('', e));\r\n\t}\r\n}","import { ILoaderOption, LoaderBase, LoaderResource } from \"./LoaderBase\";\r\n\r\nexport interface IJsonData {\r\n\t[name: string]: any;\r\n}\r\n\r\nexport type TJsonLoaderRawResource = IJsonData;\r\n\r\nexport class JsonLoaderResource extends LoaderResource<TJsonLoaderRawResource> {\r\n\tdestroy() {\r\n\t\tthis._data = {};\r\n\t}\r\n}\r\n\r\nexport type TJsonLoaderTarget = string;\r\n\r\nexport interface IJsonLoaderOption extends ILoaderOption {\r\n\r\n}\r\n\r\nexport class JsonLoader extends LoaderBase<TJsonLoaderTarget, TJsonLoaderRawResource, JsonLoaderResource> {\r\n\tprotected _loadAsync(target: TJsonLoaderTarget, options: IJsonLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tconst data = this._resolveParams(target, options);\r\n\t\t\tconst src = data.src;\r\n\t\t\tconst xhr = data.xhr;\r\n\t\t\t\r\n\t\t\tif (!xhr) {\r\n\t\t\t\treturn fetch(src);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn fetch(src, xhr.requestOptions);\r\n\t\t})()\r\n\t\t.then(res => {\r\n\t\t\tif (!res.ok) {\r\n\t\t\t\tthrow res.statusText;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then(json => new JsonLoaderResource(json, null))\r\n\t\t.catch((e: any) => new JsonLoaderResource({}, e));\r\n\t}\r\n}","\r\nimport { JsonLoader } from './JsonLoader';\r\nimport { ITextureDictionary, Spritesheet } from 'pixi.js';\r\nimport { ILoaderOption, LoaderBase, LoaderResource } from './LoaderBase';\r\nimport { TextureLoader, TextureLoaderResource } from './TextureLoader';\r\nimport { resolveUri } from '../utils';\r\n\r\nexport type TSpritesheetLoaderRawResource = ITextureDictionary;\r\n\r\nexport class SpritesheetLoaderResource extends LoaderResource<TSpritesheetLoaderRawResource> {\r\n\tdestroy() {\r\n\t\tfor (let i in this._data) {\r\n\t\t\tthis._data[i].destroy(true);\r\n\t\t}\r\n\t\t\r\n\t\tthis._data = {};\r\n\t}\r\n}\r\n\r\nexport interface ISpritesheetJson {\r\n\tframes: {\r\n\t\t[name: string]: any;\r\n\t};\r\n\t\r\n\tmeta: {\r\n\t\t[name: string]: any;\r\n\t\timage: string | HTMLImageElement;\r\n\t}\r\n}\r\n\r\nexport type TSpritesheetLoaderTarget = string | ISpritesheetJson;\r\n\r\nexport interface ISpritesheetLoaderOption extends ILoaderOption {\r\n\ttextureVersion?: string | number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst KEY_SINGLE_SPRITESHEET = '--single-spritesheet';\r\n\r\nexport class SpritesheetLoader extends LoaderBase<TSpritesheetLoaderTarget, TSpritesheetLoaderRawResource, SpritesheetLoaderResource> {\r\n\tprotected _loadAsync(target: TSpritesheetLoaderTarget, options: ISpritesheetLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tif (typeof target !== 'string') {\r\n\t\t\t\treturn this._loadTextureAsync(target, options);\r\n\t\t\t} else {\r\n\t\t\t\treturn this._loadJsonAsync(target, options);\r\n\t\t\t}\r\n\t\t})()\r\n\t\t.then(textures => new SpritesheetLoaderResource(textures, null))\r\n\t\t.catch(e => new SpritesheetLoaderResource({}, e));\r\n\t}\r\n\t\r\n\tprivate _loadJsonAsync(url: string, options: ISpritesheetLoaderOption) {\r\n\t\tconst loader = new JsonLoader();\r\n\t\t\r\n\t\treturn loader.loadAsync(url, options)\r\n\t\t\t.then(resource => {\r\n\t\t\t\tif (resource.error) {\r\n\t\t\t\t\tthrow resource.error;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!resource.data) {\r\n\t\t\t\t\tthrow 'invalid resource';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst json = resource.data;\r\n\t\t\t\t\r\n\t\t\t\tif (!json.meta || !json.meta.image || !json.frames) {\r\n\t\t\t\t\tthrow 'invalid json';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tjson.meta.image = resolveUri(url, json.meta.image);\r\n\t\t\t\t\r\n\t\t\t\tconst data: ISpritesheetJson = {\r\n\t\t\t\t\tframes: json.frames,\r\n\t\t\t\t\tmeta: json.meta\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\treturn this._loadTextureAsync(data, options);\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tprivate _loadTextureAsync(json: ISpritesheetJson, options: ISpritesheetLoaderOption) {\r\n\t\tconst loader = new TextureLoader();\r\n\t\t\r\n\t\treturn loader.loadAsync(json.meta.image, Object.assign({}, options, { version: options.textureVersion || options.version }))\r\n\t\t\t.then(resource => {\r\n\t\t\t\tif (resource.error) {\r\n\t\t\t\t\tthrow resource.error;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!resource.data) {\r\n\t\t\t\t\tthrow 'invalid resource';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst ss = new Spritesheet(resource.data, json);\r\n\t\t\t\t\r\n\t\t\t\treturn new Promise<ITextureDictionary>(resolve => {\r\n\t\t\t\t\tss.parse(e => {\r\n\t\t\t\t\t\tfor (let i in ss.textures) {\r\n\t\t\t\t\t\t\tTextureLoaderResource.removeCache(ss.textures[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tresolve(ss.textures);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n}","import { Howl } from 'howler';\r\nimport { ILoaderOption, LoaderBase, LoaderResource } from './LoaderBase';\r\n\r\nexport type TSoundLoaderRawResource = Howl | null;\r\n\r\nexport class SoundLoaderResource extends LoaderResource<TSoundLoaderRawResource> {\r\n\tdestroy() {\r\n\t\tif (this._data) {\r\n\t\t\tthis._data.stop();\r\n\t\t\tthis._data.unload();\r\n\t\t\tthis._data = null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport type TSoundLoaderTarget = string;\r\n\r\nexport interface ISoundLoaderOption extends ILoaderOption {\r\n\r\n}\r\n\r\nexport class SoundLoader extends LoaderBase<TSoundLoaderTarget, TSoundLoaderRawResource, SoundLoaderResource> {\r\n\tprotected _loadAsync(target: TSoundLoaderTarget, options: ISoundLoaderOption = {}) {\r\n\t\treturn (() => {\r\n\t\t\tconst data = this._resolveParams(target, options);\r\n\t\t\tconst src = data.src;\r\n\t\t\tconst xhr = data.xhr;\r\n\t\t\t\r\n\t\t\tif (!xhr) {\r\n\t\t\t\treturn new Promise<Howl>((resolve, reject) => {\r\n\t\t\t\t\tconst howl = new Howl({\r\n\t\t\t\t\t\tsrc,\r\n\t\t\t\t\t\tonload: () => {\r\n\t\t\t\t\t\t\tresolve(howl);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonloaderror: () => {\r\n\t\t\t\t\t\t\tconst e = new Error('invalid resource: ' + src);\r\n\t\t\t\t\t\t\treject(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn new Promise<Howl>((resolve, reject) => {\r\n\t\t\t\tconst howl = new Howl({\r\n\t\t\t\t\tsrc,\r\n\t\t\t\t\tonload: () => {\r\n\t\t\t\t\t\tresolve(howl);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonloaderror: () => {\r\n\t\t\t\t\t\tconst e = new Error('invalid resource: ' + src);\r\n\t\t\t\t\t\treject(e);\r\n\t\t\t\t\t},\r\n\t\t\t\t\txhr: xhr.requestOptions || {}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t})()\r\n\t\t.then(howl => new SoundLoaderResource(howl, null))\r\n\t\t.catch(e => new SoundLoaderResource(null, e));\r\n\t}\r\n}","import { TextureLoader, TextureLoaderResource, TTextureLoaderRawResource, TTextureLoaderTarget } from \"../loader\";\r\nimport { ManifestBase } from \"./ManifestBase\";\r\n\r\nexport class TextureManifest extends ManifestBase<TTextureLoaderTarget, TTextureLoaderRawResource, TextureLoaderResource> {\r\n\tprotected _createLoader() {\r\n\t\treturn new TextureLoader();\r\n\t}\r\n}","import { SpritesheetLoader, SpritesheetLoaderResource, TSpritesheetLoaderRawResource, TSpritesheetLoaderTarget } from \"../loader\";\r\nimport { ManifestBase } from \"./ManifestBase\";\r\n\r\nexport class SpritesheetManifest extends ManifestBase<TSpritesheetLoaderTarget, TSpritesheetLoaderRawResource, SpritesheetLoaderResource> {\r\n\tprotected _createLoader() {\r\n\t\treturn new SpritesheetLoader();\r\n\t}\r\n}","import { SoundLoader, SoundLoaderResource, TSoundLoaderRawResource, TSoundLoaderTarget } from \"../loader\";\r\nimport { ManifestBase } from \"./ManifestBase\";\r\n\r\nexport class SoundManifest extends ManifestBase<TSoundLoaderTarget, TSoundLoaderRawResource, SoundLoaderResource> {\r\n\tprotected _createLoader() {\r\n\t\treturn new SoundLoader();\r\n\t}\r\n}","import { JsonLoader, JsonLoaderResource, TJsonLoaderRawResource, TJsonLoaderTarget } from \"../loader\";\r\nimport { ManifestBase } from \"./ManifestBase\";\r\n\r\nexport class JsonManifest extends ManifestBase<TJsonLoaderTarget, TJsonLoaderRawResource, JsonLoaderResource> {\r\n\tprotected _createLoader() {\r\n\t\treturn new JsonLoader();\r\n\t}\r\n}","import { Container as PixiContainer } from 'pixi.js';\r\nimport { Container } from '../Container';\r\nimport { TJsonLoaderRawResource, TSoundLoaderRawResource, TSpritesheetLoaderRawResource, TTextureLoaderRawResource } from '../loader';\r\n\r\nexport interface IContentResourceDictionary {\r\n    images: Record<string, Exclude<TTextureLoaderRawResource, null>>;\r\n    spritesheets: Record<string, Exclude<TSpritesheetLoaderRawResource, null>>;\r\n    sounds: Record<string, Exclude<TSoundLoaderRawResource, null>>;\r\n    jsons: Record<string, Exclude<TJsonLoaderRawResource, null>>;\r\n\t[name: string]: Record<string, any>;\r\n}\r\n\r\nexport type TContentLibary = typeof PixiContainer | typeof Container;\r\nexport type TContentLibraryDictionary = Record<string, TContentLibary>;\r\n\r\nexport type TContentVariableDictionary = Record<string, any>;\r\n\r\nexport interface IContentDeliverData {\r\n\twidth: number,\r\n\theight: number,\r\n\tlib: TContentLibraryDictionary,\r\n\tresources: IContentResourceDictionary,\r\n\tvars: TContentVariableDictionary;\r\n}\r\n\r\nexport class ContentDeliver {\r\n\tprotected _piximData: IContentDeliverData;\r\n\t\r\n\tconstructor(data: IContentDeliverData) {\r\n\t\tthis._piximData = {\r\n\t\t\twidth: data.width,\r\n\t\t\theight: data.height,\r\n\t\t\tlib: data.lib,\r\n\t\t\tresources: data.resources,\r\n\t\t\tvars: data.vars\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Content width.\r\n\t */\r\n\tget width() {\r\n\t\treturn this._piximData.width;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Content height.\r\n\t */\r\n\tget height() {\r\n\t\treturn this._piximData.height;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Defined classes in content.\r\n\t */\r\n\tget lib() {\r\n\t\treturn this._piximData.lib;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loaded resources.\r\n\t */\r\n\tget resources() {\r\n\t\treturn this._piximData.resources;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Defined variables by framework.\r\n\t */\r\n\tget vars() {\r\n\t\treturn this._piximData.vars;\r\n\t}\r\n}","import { ManifestBase, IManifestClass, IManifestOption, IManifestLoaderOption, TManifestResourceVersion, TManifestLoaderXhrOption, EVENT_LOADER_ASSET_LOADED } from './ManifestBase';\r\nimport { TextureManifest } from './TextureManifest';\r\nimport { SpritesheetManifest } from './SpritesheetManifest';\r\nimport { SoundManifest } from './SoundManifest';\r\nimport { JsonManifest } from './JsonManifest';\r\nimport { ContentDeliver, IContentDeliverData, IContentResourceDictionary, TContentLibraryDictionary } from './ContentDeliver';\r\nimport { Emitter } from '@tawaship/emitter';\r\nimport { Container } from 'pixi.js';\r\nimport { ILoaderOption, LoaderResource, TJsonLoaderTarget, TSoundLoaderTarget, TSpritesheetLoaderTarget, TTextureLoaderTarget } from '../loader';\r\n\r\nexport interface IContentAssetBasepath {\r\n\t[ manifestKey: string ]: string;\r\n}\r\n\r\nexport interface IContentAssetVersion {\r\n\t[ manifestKey: string ]: TManifestResourceVersion;\r\n}\r\n\r\nexport interface IContentAssetXhrOption {\r\n\t[ manifestKey: string ]: TManifestLoaderXhrOption;\r\n}\r\n\r\nexport interface IContentAssetLoaderOption {\r\n\t[ manifestKey: string ]: ILoaderOption;\r\n}\r\n\r\nexport interface IContentManifests {\r\n    images: TextureManifest;\r\n    spritesheets: SpritesheetManifest;\r\n    sounds: SoundManifest;\r\n    jsons: JsonManifest;\r\n    [manifestKey: string]: ManifestBase<any, any, any>;\r\n}\r\n\r\nexport interface IContentConfigData {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IContentData {\r\n\tcontentID: string;\r\n\toptions: IContentOption;\r\n\t$: ContentDeliver;\r\n\tmanifests: IContentManifests;\r\n\tadditionalManifests: IContentManifests;\r\n\tpreloadPromise: Promise<void> | null;\r\n\tpostloadPromise: Promise<void> | null;\r\n\tcontentDeliverData: IContentDeliverData;\r\n}\r\n\r\nexport interface IContentOption {\r\n\t/**\r\n\t * Asset root path.\r\n\t */\r\n\tbasepath?: string | IContentAssetBasepath;\r\n\t\r\n\t/**\r\n\t * Asset version.\r\n\t */\r\n\tversion?: TManifestResourceVersion | IContentAssetVersion;\r\n\t\r\n\t/**\r\n\t * A header given when loading an asset, or a function that returns a header.\r\n\t * If a value that can be considered true is specified, fetch API will be used instead of the default Loader when loading each asset.\r\n\t */\r\n\txhr?: TManifestLoaderXhrOption;\r\n\t\r\n\ttypeOptions?: IContentAssetLoaderOption;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _contents: Record<string, typeof Content> = {};\r\n\r\n/**\r\n * @ignore\r\n */\r\nlet _contentID: number = 0;\r\n\r\nexport interface IContentStaticData {\r\n\tconfig: IContentConfigData;\r\n\tmanifests: IContentManifests;\r\n\tlib: TContentLibraryDictionary;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createManifests(): IContentManifests {\r\n\tconst res: IContentManifests = {\r\n        images: new TextureManifest(\"images\"),\r\n        spritesheets: new SpritesheetManifest(\"spritesheets\"),\r\n        sounds: new SoundManifest(\"sounds\"),\r\n        jsons: new JsonManifest(\"jsons\")\r\n    };\r\n\t\r\n\tfor (let i in _externalManifestClasses) {\r\n\t\tres[i] = new _externalManifestClasses[i](i);\r\n\t}\r\n\t\r\n\treturn res;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createContentStatic(): IContentStaticData {\r\n\treturn {\r\n\t\tconfig: {\r\n\t\t\twidth: 450,\r\n\t\t\theight: 800\r\n\t\t},\r\n\t\tmanifests: createManifests(),\r\n\t\tlib: {}\r\n\t};\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _externalManifestClasses: {\r\n\r\n    [ key: string ]: IManifestClass<any, any, any>\r\n} = {\r\n    images: TextureManifest,\r\n    spritesheets: SpritesheetManifest,\r\n    sounds: SoundManifest,\r\n    jsons: JsonManifest\r\n};\r\n\r\nexport class Content extends Emitter {\r\n\tprotected static _piximData: IContentStaticData;\r\n\tprotected _piximData: IContentData;\r\n\tprivate _loadedResourceHandler: (data: { target: any, resource: any }) => void;\r\n\t\r\n    /**\r\n     * {@link EVENT_LOADER_ASSET_LOADED} fired when any of the assets are loaded. \r\n     * @param options \r\n     * @param piximData \r\n     */\r\n\tconstructor(options: IContentOption = {}, piximData: IContentStaticData = Content._piximData) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._loadedResourceHandler = (data: { target: any, resource: any }) => {\r\n\t\t\tthis.emit(EVENT_LOADER_ASSET_LOADED, data);\r\n\t\t};\r\n\t\t\r\n\t\tconst contentDeliverData = {\r\n\t\t\twidth: piximData.config.width,\r\n\t\t\theight: piximData.config.height,\r\n\t\t\tlib: piximData.lib,\r\n\t\t\tresources: {\r\n                images: {},\r\n                spritesheets: {},\r\n                sounds: {},\r\n                jsons: {}\r\n            },\r\n\t\t\tvars: {}\r\n\t\t};\r\n\t\t\r\n\t\tthis._piximData = {\r\n\t\t\tcontentID: (++_contentID).toString(),\r\n\t\t\toptions,\r\n\t\t\t$: new ContentDeliver(contentDeliverData),\r\n\t\t\tmanifests: piximData.manifests,\r\n\t\t\tadditionalManifests: createManifests(),\r\n\t\t\tpreloadPromise: null,\r\n\t\t\tpostloadPromise: null,\r\n\t\t\tcontentDeliverData\r\n\t\t};\r\n\t\t\r\n\t\tfor (let i in this._piximData.manifests) {\r\n\t\t\tthis._piximData.manifests[i].on(EVENT_LOADER_ASSET_LOADED, this._loadedResourceHandler);\r\n\t\t}\r\n\t\t\r\n\t\tfor (let i in this._piximData.additionalManifests) {\r\n\t\t\tthis._piximData.additionalManifests[i].on(EVENT_LOADER_ASSET_LOADED, this._loadedResourceHandler);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Register manifest class.\r\n\t */\r\n\tstatic registerManifest<T, U, V extends LoaderResource<U>>(key: string, Manifest: IManifestClass<T, U, V>) {\r\n\t\t_externalManifestClasses[key] = Manifest;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Create a cloned content class.\r\n\t * \r\n\t * @param key Content name.\r\n\t * @return Cloned content class.\r\n\t */\r\n\tstatic create(key: string = ''): typeof Content {\r\n\t\tif (key && key in _contents) {\r\n\t\t\tthrow new Error(`Content key '${key}' has already exists.`);\r\n\t\t}\r\n\t\t\r\n\t\tclass ContentClone extends Content {\r\n\t\t\tprotected static _piximData: IContentStaticData = createContentStatic();\r\n\t\t\t\r\n\t\t\tconstructor(options: IContentOption = {}) {\r\n\t\t\t\tsuper(options, ContentClone._piximData);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (!key) {\r\n\t\t\treturn ContentClone;\r\n\t\t}\r\n\t\t\r\n\t\treturn _contents[key] = ContentClone;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get cloned content.\r\n\t */\r\n\tstatic get(key: string) {\r\n\t\treturn _contents[key];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove cloned content.\r\n\t * \r\n\t * @param key {string}\r\n\t */\r\n\tstatic remove(key: string): void {\r\n\t\tdelete(_contents[key]);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define assets for class.\r\n\t */\r\n\tstatic defineTargets<T>(key: string, targets: Record<string, T>, options: IManifestOption = {}) {\r\n\t\tif (!this._piximData.manifests[key]) {\r\n\t\t\tconsole.warn(`Manifest '${key}' is not registered.`);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.manifests[key].add(targets, options);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define image assets for class.\r\n\t */\r\n\tstatic defineImages(targets: Record<string, TTextureLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.defineTargets('images', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define spritesheet assets for class.\r\n\t */\r\n\tstatic defineSpritesheets(targets: Record<string, TSpritesheetLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.defineTargets('spritesheets', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define sound assets for class.\r\n\t */\r\n\tstatic defineSounds(targets: Record<string, TSoundLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.defineTargets('sounds', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define json assets for class.\r\n\t */\r\n\tstatic defineJsons(targets: Record<string, TJsonLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.defineTargets('jsons', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set the content settings.\r\n\t * \r\n\t * @param data Config data.\r\n\t */\r\n\tstatic setConfig(data: IContentConfigData) {\r\n\t\t//this._piximData.config.fps = data.fps;\r\n\t\tthis._piximData.config.width = data.width;\r\n\t\tthis._piximData.config.height = data.height;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define libraries that is material of the content.<br />\r\n\t * In the constructor named root, Application passes a reference to ContentDeliver as an argument.<br />\r\n\t * By giving this argument to the child further, you will be able to access the data freely from anywhere.\r\n\t * \r\n\t * @param data Library data.\r\n\t */\r\n\tstatic defineLibraries(data: TContentLibraryDictionary) {\r\n\t\tfor (let i in data) {\r\n\t\t\tthis._piximData.lib[i] = data[i];\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * ID of this content.\r\n\t */\r\n\tget contentID(): string {\r\n\t\treturn this._piximData.contentID;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddTargets<T>(key: string, targets: Record<string, T>, options: IManifestOption = {}): this {\r\n\t\tif (!this._piximData.additionalManifests[key]) {\r\n\t\t\tconsole.warn(`Manifest '${key}' is not registered.`);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tthis._piximData.additionalManifests[key].add(targets, options);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define image assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddImages(data: Record<string, TTextureLoaderTarget>, options: IManifestOption = {}): this {\r\n\t\treturn this.addTargets('images', data, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define spritesheet assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddSpritesheets(targets: Record<string, TSpritesheetLoaderTarget>, options: IManifestOption = {}): this {\r\n\t\treturn this.addTargets('spritesheets', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define sound assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddSounds(targets: Record<string, TSoundLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.addTargets('sounds', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define json assets for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddJsons(targets: Record<string, TJsonLoaderTarget>, options: IManifestOption = {}) {\r\n\t\treturn this.addTargets('jsons', targets, options);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Define valriables for instance.\r\n\t * \r\n\t * @return Returns itself for the method chaining.\r\n\t */\r\n\taddVars(data: Record<string, any>) {\r\n\t\tfor (let i in data) {\r\n\t\t\t this._piximData.$.vars[i] = data[i];\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Prepare content.\r\n\t */\r\n\tprepareAsync(): Promise<void> {\r\n\t\treturn this.preloadClassAssetAsync()\r\n\t\t\t.then(() => {\r\n\t\t\t\treturn this.preloadInstanceAssetAsync();\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Build content.\r\n\t */\r\n\tbuildAsync(): Promise<Container> {\r\n\t\tif (!this._piximData.$.lib.root) {\r\n\t\t\tthrow new Error('There is no library named \"root\" in the content.');\r\n\t\t}\r\n\t\t\r\n\t\treturn this.prepareAsync()\r\n\t\t\t.then(() => {\r\n\t\t\t\treturn new this._piximData.$.lib.root(this._piximData.$);\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Preloads class assets.\r\n\t */\r\n\tpreloadClassAssetAsync(): Promise<void> {\r\n\t\tif (this._piximData.preloadPromise) {\r\n\t\t\treturn this._piximData.preloadPromise;\r\n\t\t}\r\n\t\t\r\n\t\treturn this._piximData.preloadPromise = this._loadAssetAsync(this._piximData.manifests)\r\n\t\t\t.catch(e => {\r\n\t\t\t\tthis._piximData.preloadPromise = null;\r\n\t\t\t\t\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Preloads instance assets.\r\n\t */\r\n\tpreloadInstanceAssetAsync(): Promise<void> {\r\n\t\tif (this._piximData.postloadPromise) {\r\n\t\t\treturn this._piximData.postloadPromise;\r\n\t\t}\r\n\t\t\r\n\t\treturn this._piximData.postloadPromise = this._loadAssetAsync(this._piximData.additionalManifests)\r\n\t\t\t.catch(e => {\r\n\t\t\t\tthis._piximData.postloadPromise = null;\r\n\t\t\t\t\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tdestroy() {\r\n\t\tconst contentDeliverData = this._piximData.contentDeliverData;\r\n\t\t\r\n\t\tcontentDeliverData.lib = {};\r\n\t\tcontentDeliverData.vars = {};\r\n\t\t\r\n\t\tconst manifests = this._piximData.manifests;\r\n\t\tconst additionalManifests = this._piximData.additionalManifests;\r\n\t\t\r\n\t\tfor (let i in manifests) {\r\n\t\t\tmanifests[i].off(EVENT_LOADER_ASSET_LOADED, this._loadedResourceHandler);\r\n\t\t}\r\n\t\t\r\n\t\tfor (let i in additionalManifests) {\r\n\t\t\tadditionalManifests[i].off(EVENT_LOADER_ASSET_LOADED, this._loadedResourceHandler);\r\n\t\t}\r\n\t\t\r\n\t\tconst resources = contentDeliverData.resources;\r\n\t\tfor (let i in resources) {\r\n\t\t\tresources[i] = {};\r\n\t\t}\r\n\t}\r\n\t\r\n\tget classAssetCount() {\r\n\t\tlet total = 0;\r\n\t\t\r\n\t\tconst manifests = this._piximData.manifests;\r\n\t\tfor (let i in manifests) {\r\n\t\t\ttotal += manifests[i].count;\r\n\t\t}\r\n\t\t\r\n\t\treturn total;\r\n\t}\r\n\t\r\n\tget instanceAssetCount() {\r\n\t\tlet total = 0;\r\n\t\t\r\n\t\tconst additionalManifests = this._piximData.additionalManifests;\r\n\t\tfor (let i in additionalManifests) {\r\n\t\t\ttotal += additionalManifests[i].count;\r\n\t\t}\r\n\t\t\r\n\t\treturn total;\r\n\t}\r\n\t\r\n\tget assetCount() {\r\n\t\treturn this.classAssetCount + this.instanceAssetCount;\r\n\t}\r\n\t\r\n\tprivate _loadAssetAsync(manifests: IContentManifests): Promise<void> {\r\n\t\tconst loaderCount = Object.keys(manifests).length;\r\n\t\t\r\n\t\tif (loaderCount === 0) {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t\t\r\n\t\tconst options = this._piximData.options;\r\n\t\t\r\n\t\tconst basepath = (() => {\r\n\t\t\tif (typeof(options.basepath) === 'undefined') {\r\n\t\t\t\tconst basepath: IContentAssetBasepath = {};\r\n\t\t\t\tfor (let i in manifests) {\r\n\t\t\t\t\tbasepath[i] = '';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn basepath;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (typeof(options.basepath) === 'string') {\r\n\t\t\t\tconst basepath: IContentAssetBasepath = {};\r\n\t\t\t\tfor (let i in manifests) {\r\n\t\t\t\t\tbasepath[i] = options.basepath.replace(/(.+[^\\/])$/, '$1/');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn basepath;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst basepath: IContentAssetBasepath = {};\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tbasepath[i] = (options.basepath[i] || '').replace(/(.+[^\\/])$/, '$1/');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn basepath;\r\n\t\t})();\r\n\t\t\r\n\t\tconst version = (() => {\r\n\t\t\tif (typeof(options.version) === 'undefined') {\r\n\t\t\t\tconst version: IContentAssetVersion = {};\r\n\t\t\t\tfor (let i in manifests) {\r\n\t\t\t\t\tversion[i] = '';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn version;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (typeof(options.version) === 'string' || typeof(options.version) === 'number') {\r\n\t\t\t\tconst version: IContentAssetVersion = {};\r\n\t\t\t\tfor (let i in manifests) {\r\n\t\t\t\t\tversion[i] = options.version;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn version;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst version: IContentAssetVersion = {};\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\tversion[i] = options.version[i] || '';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn version;\r\n\t\t})();\r\n\t\t\r\n\t\tconst xhr = (() => {\r\n\t\t\tconst xhr: IContentAssetXhrOption = {};\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\txhr[i] = options.xhr || false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn xhr;\r\n\t\t})();\r\n\t\t\r\n\t\tconst typeOptions = (() => {\r\n\t\t\tif (typeof(options.typeOptions) === 'undefined') {\r\n\t\t\t\tconst typeOptions: IContentAssetLoaderOption = {};\r\n\t\t\t\tfor (let i in manifests) {\r\n\t\t\t\t\ttypeOptions[i] = {}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn typeOptions;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst typeOptions: IContentAssetLoaderOption = {};\r\n\t\t\tfor (let i in manifests) {\r\n\t\t\t\ttypeOptions[i] = options.typeOptions[i] || {};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn typeOptions;\r\n\t\t})();\r\n\t\t\r\n\t\tconst loaderOptions: { [ manifestKey: string ]: IManifestLoaderOption } = {};\r\n\t\tfor (let i in manifests) {\r\n\t\t\tloaderOptions[i] = {\r\n\t\t\t\tbasepath: basepath[i],\r\n\t\t\t\tversion: version[i],\r\n\t\t\t\txhr: xhr[i],\r\n\t\t\t\ttypeOptions: typeOptions[i]\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tconst resources: IContentResourceDictionary = this._piximData.$.resources;\r\n\t\t\r\n\t\tconst promises: Promise<Record<string, any>>[] = [];\r\n\t\tconst keys: string[] = [];\r\n\t\tfor (let i in manifests) {\r\n\t\t\tkeys.push(i);\r\n\t\t\t\r\n\t\t\tconst manifest = manifests[i];\r\n\t\t\t\r\n\t\t\tpromises.push(manifest.getAsync(loaderOptions[i]));\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.all(promises)\r\n\t\t\t.then(resolver => {\r\n\t\t\t\tfor (let i: number = 0; i < resolver.length;i++) {\r\n\t\t\t\t\tresources[keys[i]] = resources[keys[i]] || {};\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let j in resolver[i]) {\r\n\t\t\t\t\t\tresources[keys[i]][j] = resolver[i][j];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nContent.registerManifest('images', TextureManifest);\r\nContent.registerManifest('spritesheets', SpritesheetManifest);\r\nContent.registerManifest('sounds', SoundManifest);\r\nContent.registerManifest('jsons', JsonManifest);"],"names":["_interopNamespaceDefault","e","n","Object","create","keys","forEach","k","d","getOwnPropertyDescriptor","defineProperty","get","enumerable","default","freeze","PIXI__namespace","PIXI","Emitter","this","_events","prototype","_on","type","callback","once","const","events","i","length","push","on","off","splice","_emit","context","targets","event","let","apply","args","emit","len","arguments","ref","concat","cemit","_emitAll","emitAll","cemitAll","clear","_Emitter","Task","callbacks","_taskData","enabled","index","value","add","prototypeAccessors","configurable","set","Array","isArray","list","Function","done","task","_to","Number","first","prev","next","to","finish","reset","destroy","defineProperties","_Task","tasks","super","_piximData","emitter","constructor","call","Container","PixiContainer","taskEnabledChildren","taskEnabled","updateTask","Layer","taskHandler","obj","children","child","Application","pixiOptions","piximOptions","app","PixiApplication","stop","view","style","position","autoAdjust","isRun","container","document","body","layers","autoAdjuster","roots","contents","ticker","delta","stage","fullScreen","parentNode","appendChild","_hasLayer","name","addLayer","addChild","removeLayer","removeChild","attachAsync","content","layerName","buildAsync","then","root","detach","contentID","stageOptions","_destroyRoot","play","start","pause","paused","window","removeEventListener","addEventListener","preDestroy","removeView","rect","r","x","y","width","offsetWidth","innerWidth","height","offsetHeight","innerHeight","adjustHeight","toCenter","toTop","adjustWidth","toMiddle","toLeft","w","h","horizontal","hol","left","_getViewRect","toRight","vertical","ver","top","toBottom","parseInt","replace","EVENT_LOADER_ASSET_LOADED","ManifestBase","_data","_resources","_type","count","options","unrequired","target","getAsync","res","Promise","resolve","loader","_createLoader","onLoaded","resource","xhr","loaderOptions","assign","typeOptions","basepath","version","url","data","loadAllAsync","resources","error","destroyResources","resolveUri","uri","isUrl","preUri","resolvePath","resolveQuery","_fv","path","utils","indexOf","queries","q","t","split","search","join","LoaderResource","_error","LoaderBase","loadAsync","_loadAsync","promises","loop","all","_resolveParams","src","utils.resolveUri","utils.isUrl","BlobLoaderResource","URL","webkitURL","revokeObjectURL","BlobLoader","fetch","requestOptions","ok","statusText","blob","createObjectURL","catch","TextureLoaderResource","removeCache","texture","Texture","removeFromCache","baseTexture","BaseTexture","TextureLoader","_loadBaseTextureAsync","HTMLImageElement","HTMLVideoElement","crossOrigin","reject","bt","from","valid","JsLoaderResource","createElement","text","JsLoader","JsonLoaderResource","JsonLoader","json","SpritesheetLoaderResource","SpritesheetLoader","_loadTextureAsync","_loadJsonAsync","textures","meta","image","frames","textureVersion","ss","Spritesheet","parse","SoundLoaderResource","unload","SoundLoader","howl","Howl","onload","onloaderror","Error","TextureManifest","SpritesheetManifest","SoundManifest","JsonManifest","ContentDeliver","lib","vars","_contents","_contentID","createManifests","images","spritesheets","sounds","jsons","_externalManifestClasses","Content","piximData","_loadedResourceHandler","contentDeliverData","config","toString","$","manifests","additionalManifests","preloadPromise","postloadPromise","classAssetCount","instanceAssetCount","assetCount","registerManifest","key","Manifest","ContentClone","remove","defineTargets","console","warn","defineImages","defineSpritesheets","defineSounds","defineJsons","setConfig","defineLibraries","addTargets","addImages","addSpritesheets","addSounds","addJsons","addVars","prepareAsync","preloadClassAssetAsync","preloadInstanceAssetAsync","_loadAssetAsync","total","manifest","resolver","j","exports","Pixim"],"mappings":"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","x_google_ignoreList":[0,2]}