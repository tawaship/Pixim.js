<body style="margin: 0; overflow: hidden;">
	<div>
		<canvas id="a"></canvas>
	</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.2.1/pixi.js"></script>
<script src="../dist/Pixim.js"></script>

<script>
	/*
	new PIXI.Loader()
		.add("hoge", "fonts.png")
		.add("moge", "fonts_w.json")
		.load((loader,resources) => {
			console.log(resources)
		});
		
	*/
	/*
	class G {
		static a = {a:0}
		static k() {
			return this.a;
		}
	}
	
	class GG extends G{
		static a = {a:1}
	}
	class HH extends G{}
	console.log(HH.k())
	console.log(GG.k() === HH.k())
	*/
	
	const app = new Pixim.Application({width: 400, height: 400, view: document.getElementById("a"), resolution: 1, preserveDrawingBuffer: true}, {autoAdjust: true,container:document.body});
	//app.fullScreen({width: innerWidth, height:innerHeight})
	app.play();
	console.log(Pixim.Content)
	const A = Pixim.Content.create("A");
	const B = Pixim.Content.create("B");
	A.defineImages({
	//	hoge: "fonts.apng"
	})
	A.defineSpritesheets({
		hoge: "fonts.json"
	},{
	//	unrequired: true
	})
	/*
	A.defineImages({
		ae: "fonts_w.png"
	})
	*/
	A.defineLibraries({
		root: class A extends PIXI.Container {
			constructor($) {
				super();
				
				const g = this.addChild(new PIXI.Graphics())
				g.beginFill(0xFF0000, 1);
				g.drawRect(0, 0, 50, 50);
				
				const c = g.addChild(new Pixim.Container());
				c.task.on("A", () => {
					g.x += 1;
				})
				
				const c2 = g.addChild(new Pixim.Container());
				c2.task.on("A", () => {
					g.x += 0.5;
				})
				
				setTimeout(()=>{
					c.task.tickEnabled = false;
					//app.pause(true);
				},1000)
				
				setTimeout(()=>{
					c.task.tickEnabled = true;
					//app.pause(false);
					
				},2000)
				
				setTimeout(()=>{
					c.task.tickEnabled = true;
					//app.pause(false);
					
				},2000)
				
				this.addChild(new PIXI.Sprite($.resources.spritesheets.hoge[50]))
			}
		}
	});
	
	B.defineLibraries({
		root: class B extends PIXI.Container {
			constructor($) {
				super();
				
				const g = this.addChild(new PIXI.Graphics())
				g.beginFill(0xFFFFFF, 1);
				g.drawRect(0, 0, 100, 100);
			}
		}
	});
	const a = new A();
	
	a.addSpritesheets({
		hoge2: "fonts_w.json"
	})
	
	app.addLayer("A");
	const aa = new A();
	const bb = new B();
	
	app.attachAsync(a)
		.then(()=>{
			return app.attachAsync(bb,"A");
		})
		.then(() => {
			app.play();
			
			setTimeout(()=>{
				app.detach(bb)
			}, 1000);
			
			setTimeout(()=>{
				app.attachAsync(bb)
				//console.log(app.view.toDataURL())
			}, 1500);
		})
		.catch(e => {
			console.log(e)
		})
</script>
</body>